define({onBeginSelectionChange:function(n,t){vv.enableItem(n,this.o.jHtml.deleteButtton,t!=null)},onUpdateSuccess:function(){this.onPkRouteChange();$(this.o.jHtml.deleteButtton).addClass(this.o.classForDisabledButton).attr(this.o.disabledButtonProp,this.o.disabledButtonPropValue)},onEndAjaxloadBaseData:function(){var n=this;$(this.o.jHtml.selectTf).html($(this.o.jHtml.selectPk).html());$(this.o.jHtml.selectTf).change(function(){try{n.changeData()}catch(t){}})},onVMLoaded:function(){var n=this;$(this.o.jHtml.tab).on(this.o.jHtml.tabChangeEvent,function(){$(n.o.jHtml.allInputs).val("");try{n.changeData()}catch(t){}});$(this.o.jHtml.numberOnly).keydown(function(t){if($.inArray(t.keyCode,[46,8,9])===-1&&(t.keyCode!=65||t.ctrlKey!==!0)&&(!(t.keyCode>=35)||!(t.keyCode<=39))){var i=String.fromCharCode(t.keyCode),r=n.o.jHtml.regexNumberOnly.test(i);r||(vv.showMessage({element:$(n.o.jHtml.divAlert),type:n.o.jHtml.alertDanger,content:n.o.jHtml.alertMsg_WrongNumber}),t.preventDefault())}})},onPkRouteChange:function(){try{this.changeData(0)}catch(n){}},onDeletePoint:function(){var n=this,f,u;f=n.getTabIndex()==0?parseInt($(this.o.jHtml.selectPk+" :selected").val()):parseInt($(this.o.jHtml.selectTf+" :selected").val());n.model==null&&(n.model={});n.model.Id=f;var i=vGetObj({Id:f},n.listBase),r=Array(),t=" ";$.each(n.getTabIndex()==0?i.arrPkPoints:i.arrTfPoints,function(t,i){i.PointId==n.model.PointId&&i.PointName==n.model.PointName&&n.model.PointTime==i.PointTime&&i.PointIndex==n.model.PointIndex||r.push(i)});n.getTabIndex()==0?i.arrPkPoints=r:i.arrTfPoints=r;$.each(r,function(i,r){t+="~"+n.setString(r.PointId)+"|"+n.setString(r.PointName)+"|"+n.setString(r.PointTime)+"|"+n.setString(r.PointIndex)+"|"+n.setString(r.PointAddress)+"|"+n.setString(r.PointNearBy)+"|"});t!=null&&t!=""&&t.indexOf("~")>0&&(t=String(1)+t);u={};n.getTabIndex()==0?(i.PickedPointsInfo=t,u={PickedPointsInfo:t}):n.getTabIndex()==1&&(i.TransferPointsInfo=t,u={TransferPointsInfo:t});vRqs({_a:n.o.jVar.updateFunction,_c:{CompId:app.cid,Id:i.Id},_d:u},function(){$(n.o.jHtml.allInputs).val("");n.onUpdateSuccess()})},onSavePoint:function(){var n=this,w=$(this.o.jHtml.jTableSelectedRow).length,l,e,o,s,v,y,u,t,f,r,h,c,i,p,a;if(n.getTabIndex()==0?(l=parseInt($(this.o.jHtml.selectPk+" :selected").val()),e=$(this.o.jHtml.inputPkPointName).val(),o=$(this.o.jHtml.inputPkPointTime).val(),s=$(this.o.jHtml.inputPkPointIndex).val(),v=$(this.o.jHtml.inputPkPointNearBy).val(),y=$(this.o.jHtml.inputPkPointAddress).val()):n.getTabIndex()==1&&(l=parseInt($(this.o.jHtml.selectTf+" :selected").val()),e=$(this.o.jHtml.inputTfPointName).val(),o=$(this.o.jHtml.inputTfPointTime).val(),s=$(this.o.jHtml.inputTfPointIndex).val(),v=$(this.o.jHtml.inputTfPointNearBy).val(),y=$(this.o.jHtml.inputTfPointAddress).val()),u="",e==null||e==""?($(n.getTabIndex()==0?this.o.jHtml.inputPkPointName:this.o.jHtml.inputTfPointName).focus(),u=this.o.jHtml.alertMsg_PointName):o==null||o==""?($(n.getTabIndex()==0?this.o.jHtml.inputPkPointTime:this.o.jHtml.inputTfPointTime).focus(),u=this.o.jHtml.alertMsg_PointTime):(s==null||s=="")&&($(n.getTabIndex()==0?this.o.jHtml.inputPkPointIndex:this.o.jHtml.inputTfPointIndex).focus(),u=this.o.jHtml.alertMsg_PointIndex),u!=""){vv.showMessage({element:$(this.o.jHtml.divAlert),type:this.o.jHtml.alertDanger,content:u});return}n.model==null&&(n.model={});n.model.Id=l;t=vGetObj({Id:l},n.listBase);f=0;n.getTabIndex()==0?t.arrPkPoints==undefined||t.arrPkPoints==null?(t.arrPkPoints=[],f=1):f=t.arrPkPoints.length+1:n.getTabIndex()==1&&(t.arrTfPoints==undefined||t.arrTfPoints==null?(t.arrTfPoints=[],f=1):f=t.arrTfPoints.length+1);r={PointName:n.setString(e),PointTime:n.setString(o),PointNearBy:n.setString(v),PointId:n.setString(f),PointIndex:n.setString(s),PointAddress:n.setString(y)};h=this.model;w?(c=Array(),$.each(n.getTabIndex()==0?t.arrPkPoints:t.arrTfPoints,function(n,t){if(t.PointIndex==h.PointIndex&&t.PointName==h.PointName&&t.PointTime==h.PointTime){var i=h;i.PointName=r.PointName;i.PointTime=r.PointTime;i.PointNearBy=r.PointNearBy;i.PointIndex=r.PointIndex;i.PointAddress=r.PointAddress;c.push(i)}else c.push(t)}),n.getTabIndex()==0?t.arrPkPoints=c:n.getTabIndex()==1&&(t.arrTfPoints=c)):n.getTabIndex()==0?t.arrPkPoints.push(r):n.getTabIndex()==1&&t.arrTfPoints.push(r);n.getTabIndex()==0?t.arrPkPoints=n.sortPoints(t.arrPkPoints):n.getTabIndex()==1&&(t.arrTfPoints=n.sortPoints(t.arrTfPoints));i=" ";p=1;$.each(n.getTabIndex()==0?t.arrPkPoints:t.arrTfPoints,function(n,t){i+="~"+t.PointId+"|"+t.PointName+"|"+t.PointTime+"|"+t.PointIndex+"|"+t.PointAddress+"|"+t.PointNearBy+"|"});i!=null&&i!=""&&i.indexOf("~")>0&&(i=String(p)+i);a={};n.getTabIndex()==0?(t.PickedPointsInfo=i,a={PickedPointsInfo:i}):n.getTabIndex()==1&&(t.TransferPointsInfo=i,a={TransferPointsInfo:i});vRqs({_a:n.o.jVar.updateFunction,_c:{CompId:app.cid,Id:t.Id},_d:a},function(){$(n.o.jHtml.allInputs).val("");n.onUpdateSuccess()})},sortPoints:function(n){var t,i,r;if(!(n!="undefined"&&n!=null&&n.length!="undefined"&&n.length>1))return n;for(t=0;t<n.length-1;t++)for(i=t+1;i<n.length;i++)parseInt(n[i].PointIndex)<parseInt(n[t].PointIndex)&&(r=n[t],n[t]=n[i],n[i]=r);return n},setString:function(n){return typeof n=="undefined"||n==null?"":n},getTabIndex:function(){return $(this.o.jHtml.tabIndex).eq(0).hasClass("active")?0:1},mapPoints:function(n){var t,r,i=[],u;return(t=this.getTabIndex()==0?n.PickedPointsInfo:n.TransferPointsInfo,t==null||t=="")?i:(t.indexOf("~")>=0&&(t=t.substring(t.indexOf("~")+1),r=t.split("~"),$.each(r,function(n,t){u={PointId:vGdi(t,"|",0),PointName:vGdi(t,"|",1),PointTime:vGdi(t,"|",2),PointIndex:vGdi(t,"|",3),PointAddress:vGdi(t,"|",4),PointNearBy:vGdi(t,"|",5),PointLocationId:vGdi(t,"|",6)};i.push(u)})),i)},changeData:function(){var u=this,i=this.getTabIndex()==0?parseInt($(this.o.jHtml.selectPk+" :selected").val()):parseInt($(this.o.jHtml.selectTf+" :selected").val()),n,r,t;(this.model==null||this.model==undefined)&&(this.model={});this.model.Id=i;n=vGetObj({Id:i},this.listBase);n&&(r=this.mapPoints(n));t=$("#"+this.o.gId).jtable("selectedRows");t.length>0&&$("#"+this.o.gId).jtable("deselectRows",t);$("#"+this.o.gId).jtable("removeAllRows");$("#"+this.o.gId).jtable("addLocalRecords",function(n,t){return u._listAction(r,t)});$("#"+this.o.gId).unmask()},gDpkPointNearBy:function(n){var t=n.record.PointNearBy;return t=="undefined"?"":t}});
//# sourceMappingURL=p.min.js.map
