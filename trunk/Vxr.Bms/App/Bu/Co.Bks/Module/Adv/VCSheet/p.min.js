define({start:function(n){var t,i,r;try{t=this;t.o=n;t._$container=$(n.x);i=!1;r={x:"#VCFilterForm button[name=searchVC]"};vbv("doShowVC",function(u){t._$container.length==0&&(t._$container=$(n.x));$('select[name="TimeSlot"]#time').val()!="All"&&$('input[name="DepartureDateTo"]').prop("disabled",!0);t._bindEventOnField();t._bindSearchEvents(r,u);i==!1&&(t._createVC(),i=!0);t._rlVc(u.d.td)});vbv("doChangeVCTrip",function(n){t.o._cVCTripId=n.d.value})}catch(u){console.log("(E) VSheet",u)}},_createVC:function(){this._$vcsheet=$("<div />").addClass("vcancelled-sheet  col-md-12 col-sm-12 col-xs-12").appendTo(this._$container);this._$vcnav=$("<div />").addClass("vcanclled-nav  col-md-12 col-sm-12 col-xs-12").append($("<div />").addClass("col-md-12")).appendTo(this._$container).children().first()},_rlVc:function(n){var t=this,i=t.o,r=t._createGetVCSeatObj(),u=function(r,u,f,e){if(r!=1||f<=0){t._clearVCSheet();t._notFoundCancelledTicket();return}t._clearVCSheet();f>0&&(t._mapVCTicket(u,n),i._totalVCItem=parseInt(e));t._renderVCSheet(n);t._renderVCPagination(n)};vRqs(r,u)},_createGetVCSeatObj:function(){var t=$('input[name="DepartureDateFrom"]').val().split(" ")[2].split("-")[2]+"-"+$('input[name="DepartureDateFrom"]').val().split(" ")[2].split("-")[1]+"-"+$('input[name="DepartureDateFrom"]').val().split(" ")[2].split("-")[0],u=$('input[name="DepartureDateTo"]').val().split(" ")[2].split("-")[2]+"-"+$('input[name="DepartureDateTo"]').val().split(" ")[2].split("-")[1]+"-"+$('input[name="DepartureDateTo"]').val().split(" ")[2].split("-")[0],r=$("#time").val(),n={},f=this,i=f.o;return n._a="pGetTicket",n._c={TripId:i._cVCTripId,Status:"($x) = 3"},r=="All"?n._ft="TripId = "+i._cVCTripId+" and (Status) = 3 and CanceledDate >= '"+t+" 00:00' and CanceledDate <= '"+u+" 23:59'":(n._ft="TripId = "+i._cVCTripId+" and (Status) = 3 and TripDate >= '"+t+" 00:00' and TripDate <= '"+t+" 23:59' and convert(VARCHAR(40),TripDate,121) like '%"+r+"%'",n._c.TripDate=t),n._f=_dict._tgF.join(),n._se="Id desc",n._si=i._cVCPageIndex,n._mr=_dict._nOP,n},_clearVCSheet:function(){this._$vcsheet.empty();this._$vcnav.empty()},_mapVCTicket:function(n,t){var i=this;i._vc=[];$.each(n,function(n,r){r.shift();var u=i._crTkFrRc(r,t);$.isEmptyObject(u)||i._vc.push(u)})},_renderVCSheet:function(n){var t=this,s=$("<ul/>").addClass("coach vbooking-coach").addClass(_dict._g[n._numCoach-2]).addClass(_dict._sg[n._numCoach-2]).addClass(_dict._mg[n._numCoach-2]).appendTo(t._$vcsheet),h=_dict._cTplTb,f,e,i,u,r,o;if(s.append(h),t._vc.length>0)for(f=0,e=Math.round(t._vc.length/n._numCoach),i=0;i<t._vc.length;i+=e)for(u=t._vc.slice(i,i+e),r=0;r<u.length;r++)typeof u[r]!="undefined"&&(f++,o=u[r]._renderVCTicket(f),$(".innerTable").append(o));else t._notFoundCancelledTicket()},_renderVCPagination:function(n){var r=this,e=r.o,t=r._getVCPag(e._cVCPageIndex,_dict._nOP,e._totalVCItem),i,u,f;if(t.CountAllPages>1){if(i=$("<ul />").addClass("pagination pagination-sm pull-right"),t.FrevPage!=""?i.append($("<li />").append($("<a />").html("&laquo;").attr("href","javascript:;").attr("data-index",t.FrevPage))):i.append($("<li />").addClass("disabled").append($("<a />").html("&laquo;").attr("href","javascript:;").attr("data-index",""))),t.FrevPages.length>0)for(u=0;u<t.FrevPages.length;u++)i.append($("<li />").append($("<a />").html(t.FrevPages[u]).attr("href","javascript:;").attr("data-index",t.FrevPages[u])));if(i.append($("<li />").addClass("active").append($("<a />").html(t.CurrentPage).attr("href","javascript:;").attr("data-index",t.CurrentPage))),t.NextPages.length>0)for(f=0;f<t.NextPages.length;f++)i.append($("<li />").append($("<a />").html(t.NextPages[f]).attr("href","javascript:;").attr("data-index",t.NextPages[f])));t.NextPage!=""?i.append($("<li />").append($("<a />").html("&raquo;").attr("href","javascript:;").attr("data-index",t.NextPage))):i.append($("<li />").addClass("disabled").append($("<a />").html("&raquo;").attr("href","javascript:;").attr("data-index","")));i.appendTo(r._$vcnav);i.find("a").not(".disabled").on("click",function(t){t.preventDefault();t.stopPropagation();r._changeVCPageIndex($(this).attr("data-index"));r._rlVc(n)})}},_getVCPag:function(n,t,i){for(var u,e,f=Math.ceil(i/t),r=[],o=n-5;o<n;o++)o>=1&&r.push(o);for(u=[],e=n+1;e<n+5;e++)e<=f&&u.push(e);return{CurrentPage:n,CountAllPages:f,First:-1==r.indexOf(1)&&1!=n?1:"",FrevPage:r.length>0?r[r.length-1]:"",FrevPages:r,NextPages:u,NextPage:u.length>0?u[0]:"",Last:-1==u.indexOf(f)&&f!=n?f:"",NumPerPage:t}},_notFoundCancelledTicket:function(){var n=this;$("<div />").addClass("alert alert-danger").html("<strong>Không tồn tại vé đã hủy.<\/strong>").appendTo(n._$vcsheet)},_changeVCPageIndex:function(n){this.o._cVCPageIndex=parseInt(n)},_crTkFrRc:function(n,t){var p=parseInt(n[8]),w=parseInt(n[22]),u,f,e;if(w==t._cTripBus){var b=parseInt(n[0]),k=vPrsDt(n[5]),i=new Date(vPrsDt(n[6])),d=i.getDate()+"-"+(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-"+i.getFullYear(),g=i.getHours()+":"+i.getMinutes()+"0",nt=n[4].split("|")[0],o=parseInt(n[9]);isNaN(o)&&(o=0);var tt=n[10],it=n[11],rt=n[12],s=n[13];null==s&&(s="");var ut=n[14],ft=n[15],et=n[16],ot=vPrsDt(n[17]),st=vPrsDt(n[18]),ht=vPrsDt(n[19]),ct=n[20],h=parseInt(n[21]);isNaN(h)&&(h=0);u=parseInt(n[26]);isNaN(u)&&(u=0);f=parseInt(n[27]);isNaN(f)&&(f=0);e=parseInt(n[29]);isNaN(e)&&(e=0);var lt=n[23],at=n[24],vt=parseInt(n[25]),yt=parseInt(n[1]),pt=vPrsDt(n[3]),l=0,a="",v="",r=n[7];r!=null&&(r=r.split("|"),l=parseInt(r[2]),a=r[3],v=r[4]);var wt=n[28],bt=n[29],c=parseInt(n[30]);isNaN(c)&&(c=1);var kt=n[32],dt=n[33],gt=n[34],ni=n[35],ti=n[36],ii=n[37],ri=n[38],y=new T(b,pt,l,a,v,p,k,d,o,tt,it,rt,s,ut,ft,et,ot,st,ht,ct,h,lt,at,vt,yt,u,f,wt,bt,c,e,kt,dt,gt,ni,ti,ii,ri,nt,g);return y.agentId=n[2],y}return{}},_bindSearchEvents:function(n,t){var r=$(n.x),i;me=this;i=t;r.length>0&&vev(n.x,"click",function(){me._rlVc(i.d.td)})},_bindEventOnField:function(){var n=$('select[name="TimeSlot"]#time');n.change(function(){n.val()=="All"?$('input[name="DepartureDateTo"]').prop("disabled",!1):$('input[name="DepartureDateTo"]').prop("disabled",!0)})}});
//# sourceMappingURL=p.min.js.map
