define({start:function(){var n=this;vbv("doGetWarningCustomer",function(t){t.d&&n._getCustomerWarning(t.d.f,t.d.cName,t.d.cPhone,t.d.cId,t.d.lmDate,t.d.tId,t.d.tName)});vbv("doClearWarningCustomer",function(t){t.d&&n._clearCustomerWarning(t.d.f)})},_getCustomerWarning:function(n,t,i,r){var u=this;vRqs({_a:"fGetTicket",_c:{CustomerId:r,TripDate:"($x >= '"+(new Date).toFormatString("iso")+"')",Status:"(($x) IN("+_dict._tksUpSearch.join()+") AND ($x <> 1 OR ($x = 1 AND (ExpiredTime is null OR (ExpiredTime is not null AND ExpiredTime >= '"+(new Date).toFormatString("iso")+"'))))) ORDER BY TripDate ASC"},_f:"TripDate, SeatCode, Fare, Status, TripIdName"},function(r,f,e){r==1&&(u._clearCustomerWarning(n),e>0&&u._renderCustomerWarning(n,t,i,f))})},_clearCustomerWarning:function(n){n&&n.find(".customer-w").remove()},_renderCustomerWarning:function(n,t,i,r){var f=$("<ul />"),u=[],s=[],e,o;$.each(r,function(n,t){var r=vPrsDt(t[0]),f=t[1].split("|")[0],e=parseInt(t[2]),h=parseInt(t[3]),o=t[4],i=s.indexOf(r.toFormatString("iso"));i==-1&&(i=s.push(r.toFormatString("iso"))-1);typeof u[i]=="undefined"&&(u[i]={_b:{_numS:0,_sCodes:[],_total:0,_tname:o,_date:r},_c:{_numS:0,_sCodes:[],_total:0,_tname:o,_date:r},_p:{_numS:0,_sCodes:[],_total:0,_tname:o,_date:r}});switch(h){case 1:u[i]._b._numS++;u[i]._b._sCodes.push(f);u[i]._b._total+=e;break;case 2:u[i]._p._numS++;u[i]._p._sCodes.push(f);u[i]._p._total+=e;break;case 4:u[i]._c._numS++;u[i]._c._sCodes.push(f);u[i]._c._total+=e}});$.each(u,function(n,t){var i,r,u;typeof t!="undefined"&&t!=null&&(t._b._numS>0&&(i={t:{_sText:"Đang đặt",_numS:t._b._numS,_sCodes:t._b._sCodes.join(", "),_total:t._b._total.toMn()+"₫",_tname:t._b._tname,_date:t._b._date.toFormatString("dd-mm-yyyy"),_time:t._b._date.toFormatString("hh:mm")}},f.append(vtpl(_dict._btwarningTpl,i))),t._c._numS>0&&(r={t:{_sText:"Hủy",_numS:t._c._numS,_sCodes:t._c._sCodes.join(", "),_total:t._c._total.toMn()+"₫",_tname:t._c._tname,_date:t._c._date.toFormatString("dd-mm-yyyy"),_time:t._c._date.toFormatString("hh:mm")}},f.append(vtpl(_dict._btwarningTpl,r))),t._p._numS>0&&(u={t:{_sText:"Đã thanh toán",_numS:t._p._numS,_sCodes:t._p._sCodes.join(", "),_total:t._p._total.toMn()+"₫",_tname:t._p._tname,_date:t._p._date.toFormatString("dd-mm-yyyy"),_time:t._p._date.toFormatString("hh:mm")}},f.append(vtpl(_dict._btwarningTpl,u))))});f.find("li").length>0&&n.find("#UpdateForm").prepend($(vtpl(_dict._wTpl,{m:{_cname:t,_cphone:i,_content:$("<div />").append(f).html()}})).addClass("customer-w"));e=n.find("div.message-error");e.length>0&&(e.html(""),e.hide());o=n.find('input[name="PhoneNumbers"]').closest("div.col-md-6");o.length>0&&o.hasClass("has-error")&&o.removeClass("has-error")}});
//# sourceMappingURL=p.min.js.map
