var I=function(n,t,i,r,u,f){this._coach=parseInt(n);this._row=parseInt(t);this._col=parseInt(i);this._status=parseInt(r);this._class=u;this._label=f},S=function(n,t,i,r,u,f,e){I.call(this,n,t,i,r,u,f);this._type=parseInt(e);this._tickets=[];this._tickets_idxMaxStageCode=0;this._currentTicketIndex=-1;this._seatStatus=0};S.prototype._renderSeat=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var b=this,p=b._getCurrentTicket(i),yt=b._coach+"|"+b._row+"|"+b._col,dt,ei,et,k,oi,ot,d,gt,ni,si,st,hi,ht,ct,w,lt,at,it,nt,ut,ii,vt,tt,ri,ui;p._status==3&&(b._status=1);p._status!=3&&(typeof _dict._blockSeatByVehicle!="undefined"&&$.each(_dict._blockSeatByVehicle,function(n,t){yt==t&&(b._status=2)}),typeof _dict._blockSeatByTrip!="undefined"&&typeof _dict._blockSeatByTrip[a]!="undefined"&&$.each(_dict._blockSeatByTrip[a],function(n,t){yt==t&&(b._status=2)}),typeof _dict._unblockSeatByVehicle!="undefined"&&c!=""&&typeof _dict._unblockSeatByVehicle[c]!="undefined"&&_dict._unblockSeatByVehicle[c].indexOf(yt)!=-1&&(b._status=1),vIsEstStr(app.agentBlockSeats)&&$.each(app.agentBlockSeats.split(","),function(n,t){b._label==t.trim()&&(b._status=2)}));var g=$(),rt=null,pt="",ft=null,wt="",fi="",bt=0,kt=0;if(typeof _dict._hasDefaultStagePerTrip!="undefined"&&_dict._hasDefaultStagePerTrip&&typeof _dict._defaultStagePerTrip[a]!="undefined"&&(dt=_dict._defaultStagePerTrip[a].split(","),bt=parseInt(dt[0]),kt=parseInt(dt[1])),vIsEstStr(p.fromArea)?(ei=p.fromArea.indexOf("~"),et=p.fromArea.substr(ei+1,p.fromArea.length).split("|"),rt={Id:et[0],Type:et[1],Code:et[2],Name:et[3]}):(k=null,typeof u.idx[bt]!="undefined"?(k=u.data[u.idx[bt]],rt={Id:k.Id,Type:k.Type,Code:k.Code,Name:k.Name}):(k=u.data[0],rt={Id:k.Id,Type:k.Type,Code:k.Code,Name:k.Name})),vIsEstStr(p.toArea)?(oi=p.toArea.indexOf("~"),ot=p.toArea.substr(oi+1,p.toArea.length).split("|"),ft={Id:ot[0],Type:ot[1],Code:ot[2],Name:ot[3]}):(d=null,typeof u.idx[kt]!="undefined"?(d=u.data[u.idx[kt]],ft={Id:d.Id,Type:d.Type,Code:d.Code,Name:d.Name}):(d=u.data[u.data.length-1],ft={Id:d.Id,Type:d.Type,Code:d.Code,Name:d.Name})),rt&&rt.Id!=u.data[0].Id&&(pt=rt.Code),ft&&(wt=ft.Code),fi=vIsEstStr(pt)?pt+" - "+wt:wt,gt={Id:"",Type:"",Code:"",Name:""},ni={Id:"",Type:"",Code:"",Name:""},vIsEstStr(p._fromStop)&&(si=p._fromStop.indexOf("~"),st=p._fromStop.substr(si+1,p._fromStop.length).split("|"),gt={Id:st[0],Type:st[1],Code:st[2],Name:st[3]}),vIsEstStr(p._toStop)&&(hi=p._toStop.indexOf("~"),ht=p._toStop.substr(hi+1,p._toStop.length).split("|"),ni={Id:ht[0],Type:ht[1],Code:ht[2],Name:ht[3]}),b._isAvailable()){if(ct=p._fare,vIsEstStr(p._surCharge)&&(ct+=parseInt(p._surCharge)),vIsEstStr(p._discount)&&(ct-=parseInt(p._discount)),w={seat:{_coach:b._coach,_row:b._row,_col:b._col,_class:"available",_label:b._label,_pInfo:"",_numStagetickets:"",_stageticketsTooltips:"",_note:p._note,_cname:vGln(p._cname),_cphone:"",_nTicketPerTrip:n>1?" "+n+"G":"",_pmInfo:"",_suser:"",_cuser:"",_fare:vIsEstStr(ct)?ct.toMn()+"đ":"",_code:"",_notallow:"",_fromStop:gt,_toStop:ni}},v){var ti="",li=!0,ci=b._renderStageTicketsInfo_Tooltips(b._tickets,u);$.isEmptyObject(p)?y!=undefined&&y&&(w.seat._class="vxr",w.seat._pmInfo="VXR",w.seat._suser="B:&nbsp;admin.vxr",w.seat._cuser="&nbsp;/&nbsp;P:&nbsp;admin.vxr"):(w.seat._stageticketsTooltips=ci,w.seat._numStagetickets=b._tickets.length,w.seat._stageName=fi,lt=p._getPickupInfo(),ti=lt.type,w.seat._class=_dict._cc[p._status],w.seat._pInfo=$.isEmptyObject(lt)?"":lt.text,w.seat._cphone=p._getDefaultPhoneNumber(),w.seat._code=p._getTicketCode(),li=!1,vIsEstStr(p._suser)&&(w.seat._suser="B:&nbsp;"+p._suser),vIsEstStr(p._firstUserUpdated)&&(w.seat._fUserUpdated="B:&nbsp;"+p._firstUserUpdated),b._updatePaymentInfo_AgentInfo_ToSeat(w,p),w.seat._pmInfo.indexOf("VXR")>0&&(w.seat._class+=" vxr"),at=!0,it=[],_dict._isFBooking.length>0&&$.each(_dict._isFBooking,function(n,t){var u,i,r;if(typeof t!="undefined"&&t!=null)for(u=t.split("|"),typeof it[n]=="undefined"&&(it[n]=!1),i=0;i<u.length;i++){r=p[u[i]];switch(typeof r){case"string":it[n]=it[n]||vIsEstStr(r);break;case"object":it[n]=it[n]||!$.isEmptyObject(r)}}}),$.each(it,function(n,t){at=at&&t}),at&&(w.seat._class+=" fbooking"),p._isCancelled()&&(w.seat._cuser="&nbsp;/&nbsp;C:&nbsp;"+p._getLastUpdateUser(),o==1&&p._canceledDate>s&&(w.seat._class="booking"),(p._cuser!=null||vIsEstStr(p._cuser))&&(w.seat._class="paid",w.seat._pmInfo==" - VXR"&&(w.seat._class+=" vxr"))),y!=undefined&&y&&p._type==3&&(w.seat._suser="B:&nbsp;admin.vxr",w.seat._cuser="&nbsp;/&nbsp;P:&nbsp;admin.vxr",w.seat._class="vxr"));b._tickets.length>=1&&(nt=p.stageCode,t=!1,nt||(nt=0),(nt&i)==0?(w.seat._numStagetickets=b._tickets.length,w.seat._stageticketsTooltips=ci,w.seat._class=w.seat._class.replace("booking","").replace("fbooking",""),t=!0):nt==i||nt==1?t=!0:nt&i&&nt!=i&&(b.disableClickEvent=!0,w.seat._class="",ut=b._getFirstStageTicketInSeat(),w.seat._cphone=ut._getDefaultPhoneNumber(),ii=p._getPickupInfo(),ti=lt.type,w.seat._pInfo=$.isEmptyObject(ii)?"":ii.text,w.seat._cphone=ut._getDefaultPhoneNumber(),w.seat._cname=vGln(ut._cname),w.seat._note=ut._note,b._updatePaymentInfo_AgentInfo_ToSeat(w,ut),vIsEstStr(p._suser)&&(w.seat._suser="B:&nbsp;"+p._suser),w.seat._numStagetickets=b._tickets.length,w.seat._label=e==nt?_dict._fullStageTicketLable:_dict._stageTicketLable,p.isStageSeat=!0));b._tickets.length!=1||f||p.stageCode!=i&&i!=0||(w.seat._numStagetickets="");t&&(vt=$("<div />"),tt=0,$.isEmptyObject(p)||(tt=p._status),ri=_dict._st[tt],p._type!=2?($.each(_dict._at,function(n,t){if(ri.indexOf(n)!=-1){var i=!0;o==2||y?i=!1:(t[1]=="B"&&(app.rights.indexOf($.rights.bBook.val)==-1||o==1&&_dict._disAllowBkAtrDpt&&app.rights.indexOf($.rights.bBkAtDpt.val)==-1)&&(i=!1),t[1]=="U"&&app.rights.indexOf($.rights.bUpdate.val)==-1&&(i=!1),t[1]=="M"&&!_dict._stageTicketshowMButton&&f&&(i=!1),app.rights.indexOf($.rights.bEnBtnAtDpt.val)==-1&&t[1]=="M"&&(tt==2||tt==5)&&o==1&&h&&(i=!1),t[1]=="M"&&app.rights.indexOf($.rights.bMove.val)==-1&&(i=!1),app.rights.indexOf($.rights.bQBook.val)==-1?t[1]=="P"&&(i=!1):t[1]=="P"&&tt!=1&&(i=!1),app.rights.indexOf($.rights.bQPay.val)==-1?t[1]=="Q"&&(i=!1):t[1]=="Q"&&tt!=1&&(i=!1));l||i&&vt.append($("<button />",{text:t[1],type:"button"}).addClass(t[4]).attr("data-type",t[5]))}}),w.seat._notallow=typeof l!="undefined"&&l?"notallow":""):app.rights.indexOf($.rights.bEdtOnlTic.val)!=-1&&($.each(_dict._at,function(n,t){if(ri.indexOf(n)!=-1){var i=!0;o==2?i=!1:(t[1]=="U"&&(app.rights.indexOf($.rights.bUpdate.val)==-1||app.rights.indexOf($.rights.bUpOl.val)==-1)&&(i=!1),t[1]=="M"&&((app.rights.indexOf($.rights.bMove.val)==-1||!_dict._stageTicketshowMButton&&f)&&(i=!1),o==1&&h&&app.rights.indexOf($.rights.bEnBtnAtDpt.val)==-1&&(tt==2||tt==5)&&(i=!1)),t[1]=="P"&&(i=!1),t[1]=="Q"&&(i=!1));l||i&&vt.append($("<button />",{text:t[1],type:"button"}).addClass(t[4]).attr("data-type",t[5]))}}),w.seat._notallow=typeof l!="undefined"&&l?"notallow":""),w.seat.buttons=vt.html())}$.isEmptyObject(p)&&b._tickets.length<=0?g=$(vtpl(_dict._sTpl,w)):$.isEmptyObject(p)&&b._tickets.length>=1?g=$(vtpl(_dict._svcTpl,w)):p.stageCode>=e||p.stageCode==1?v&&(g=$(vtpl(_dict._sTpl,w))):g=$(vtpl(_dict._svcTpl,w));ti=="T"&&g.find(".pick").addClass("transfer");w.seat._pInfo==""&&g.find(".pick").css("background","none");p._seri!=null&&p._seri!=""&&g.find(".seat-code").addClass("exported")}else ui={seat:{_label:b._label}},g=p.stageCode>=e?$(vtpl(_dict._lksvcTpl,ui)):$(vtpl(_dict._lksTpl,ui));return g};S.prototype._updatePaymentInfo_AgentInfo_ToSeat=function(n,t){var i=t._getPaymentInfo(),r=t._getAgentInfo();if($.isEmptyObject(i))$.isEmptyObject(r)||(n.seat._pmInfo=r._code,n.seat._pmFullInfo="CN/ĐL:&nbsp;"+r._name);else{switch(i.type){case 1:case 6:typeof i.info!="undefined"&&(n.seat._pmInfo=i.info._code,n.seat._pmFullInfo="CN/ĐL:&nbsp;"+i.info._name);break;case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:n.seat._pmInfo=i.sname;n.seat._pmFullInfo="CN/ĐL:&nbsp;"+i.name}vIsEstStr(t._cuser)&&!t._isCancelled()&&(n.seat._cuser="&nbsp;/&nbsp;P:&nbsp;"+t._cuser)}typeof n.seat._pmInfo!="undefined"&&n.seat._pmInfo.length>0&&(n.seat._pmInfo=" - "+n.seat._pmInfo)};S.prototype._getFirstStageTicketInSeat=function(){var n=this,t;return n._tickets_idxMaxStageCode==-1?{}:(t=n._tickets[n._tickets_idxMaxStageCode],t?t:{})};S.prototype._renderStageTicketsInfo_Tooltips=function(n,t){var i="",r;return t&&(r=t.data.length-1,$.each(n,function(n,u){var a="T"+u._id,o=u.stageCode.toString(2),e=r-o.length,f=o.indexOf("0");f=f==-1?r:e+f;u.stage_Idx1=e;u.stage_Idx2=f;var h=u._cphone?u._cphone:"",c=u._cname?u._cname:"",l="<p class='nhieu-chang-ng-dat'><small>"+c+" "+h+"<\/small><\/p>",s="";t.data[e]!=null&&(u.stage_point1=t.data[e],u.stage_point2=t.data[f],s="<a href='#' data-fromId='"+u.stage_point1.Id+"' data-toId='"+u.stage_point2.Id+"' class='stage-ticket-context'>"+u.stage_point1.Code+" - "+u.stage_point2.Code+"<\/a>");i=i+"<li>"+s+l+"<\/li>"})),i};S.prototype._renderPrintStageSeat=function(){var n=this,t={pseat:{_label:n._label,_pmInfo:"",_cname:"",_cphone:"",_note:"VÉ CHẶNG",_nTicketPerTrip:"",_hidden:"hidden",_seri:n._code}};return $(vtpl(_dict._pssTpl,t))};S.prototype._renderPrintSeat=function(n,t,i){var d=this,r=d._getCurrentTicket(),h=null,y="",p=null,w="",g={Id:"",Type:"",Code:"",Name:""},nt={Id:"",Type:"",Code:"",Name:""},tt="",it,c,rt,l,ut,a,ft,v,u,f,o,et,e,s,b,k;if(vIsEstStr(r.fromArea)&&(it=r.fromArea.indexOf("~"),c=r.fromArea.substr(it+1,r.fromArea.length).split("|"),h={Id:c[0],Type:c[1],Code:c[2],Name:c[3]}),vIsEstStr(r.toArea)&&(rt=r.toArea.indexOf("~"),l=r.toArea.substr(rt+1,r.toArea.length).split("|"),p={Id:l[0],Type:l[1],Code:l[2],Name:l[3]}),vIsEstStr(r._fromStop)&&(ut=r._fromStop.indexOf("~"),a=r._fromStop.substr(ut+1,r._fromStop.length).split("|"),g={Id:a[0],Type:a[1],Code:a[2],Name:a[3]}),vIsEstStr(r._toStop)&&(ft=r._toStop.indexOf("~"),v=r._toStop.substr(ft+1,r._toStop.length).split("|"),nt={Id:v[0],Type:v[1],Code:v[2],Name:v[3]}),h&&(t?h.Id!=t.data[0].Id&&(y=h.Code):y=h.Code),p&&(w=p.Code),tt=vIsEstStr(y)?y+" - "+w:w,u={pseat:{_label:d._label,_pmInfo:"",_cname:vGln(r._cname),_cphone:"",_note:r._note,_nTicketPerTrip:n>1?"-"+n+"G":"",_cFullName:r._cname,_stageName:tt}},$.isEmptyObject(r))u.pseat._hidden="hidden";else{if(r._status!=1&&(u.pseat._dathanhtoan="da-thanh-toan"),u.pseat._cphone=r._getDefaultPhoneNumber(),u.pseat._fare=r._fare.toMn()+"đ",u.pseat._cuser=r._cuser,u.pseat._suser=r._suser,typeof _dict._onlyPaidBackGround!="undefined"&&_dict._onlyPaidBackGround&&r._status==1&&(u.pseat._onlyPaidBackGround="no-background"),f=r._getPaymentInfo(),o=r._getAgentInfo(),$.isEmptyObject(f))$.isEmptyObject(o)||(typeof _dict._noShowAgentInfo!="undefined"&&_dict._noShowAgentInfo?(u.pseat._pmInfo="",u.pseat._pmFullInfo=""):(u.pseat._pmInfo=o._code,u.pseat._pmFullInfo=o._name));else{u.pseat._paid="paid";switch(f.type){case 1:typeof _dict._showUCharge!="undefined"&&_dict._showUCharge?r._cuser!=""?(et=r._cuser.split("."),u.pseat._pmInfo=et[0]):u.pseat._pmInfo="":$.isEmptyObject(f.info)?(u.pseat._pmInfo=o._code,u.pseat._pmFullInfo=o._name):(u.pseat._pmInfo=f.info._code,u.pseat._pmFullInfo=f.info._name);break;case 6:u.pseat._pmInfo=f.info._code;u.pseat._pmFullInfo=f.info._name;break;case 2:case 3:case 4:typeof _dict._noBackground!="undefined"&&_dict._noBackground&&(u.pseat._nobackground="no-background");u.pseat._pmInfo=f.sname;u.pseat._pmFullInfo=f.name;break;case 5:case 7:case 8:case 9:case 10:u.pseat._pmInfo=f.sname;u.pseat._pmFullInfo=f.name}}if(vIsEstStr(r._seri)&&(u.pseat._exported="exported"),e=r._getPickupInfo(),$.isEmptyObject(e)?u.pseat._hidden="hidden":_dict._hasTransferOnPST?(e.type=="P"&&(u.pseat._pInfo=e.text),e.type=="T"&&_dict._disTransferOnPST!=undefined&&(u.pseat._pInfo=_dict._disTransferOnPST=="default"?e.text:_dict._disTransferOnPST)):e.type=="P"&&(u.pseat._pInfo=e.text),s="",r._status==1)s="CTiền";else if(r._status!=2||$.isEmptyObject(f))r._status==5&&(s="KoThu");else switch(f.type){case 1:vIsEstStr(r._staffName)&&(b=r._staffName.split(" "),s=b[b.length-1]);break;case 6:s=f.info._code}u.pseat._ttPayment=s}return u.pseat._fromStop=g,u.pseat._toStop=nt,k=$(vtpl(_dict._psTpl,u)),i!=null&&(u.data=i,k=$(vtpl(_dict._psTpl_SeatGroup,u))),k};S.prototype._renderCustomData=function(n){return $(vtpl(_dict._psTpl_SeatGroup,n))};S.prototype._renderLSeat=function(n,t,i,r,u){var s=this,c=$(),f=null,e,h,o,k,v;if(s._isAvailable()){if(f=typeof r!="undefined"?r:s._getCurrentTicket(),e={seat:{_index:t,_coach:s._coach,_row:s._row,_col:s._col,_class:"available",_pInfo:"",_label:s._label,_cname:vGln(f._cname),_nTicketPerTrip:n>1?"("+n+"G)":"",_cphone:"",_idate:"",_total:0,_status:"",_pmInfo:"",_pmFullInfo:"",_suser:"",_cuser:"",_note:f._note,_stageName:u,_fromCode:"",_fromName:"",_toCode:"",_toName:""}},!$.isEmptyObject(f)){if(f.fromArea!=undefined&&f.fromArea!=null){var l=f.fromArea.split("|"),y=l[2],p=l[3];e.seat._fromCode=y;e.seat._fromName=p}if(f.toArea!=undefined&&f.toArea!=null){var a=f.toArea.split("|"),w=a[2],b=a[3];e.seat._toCode=w;e.seat._toName=b}if(h=f._getPickupInfo(),$.isEmptyObject(h)||(e.seat._pInfo=h.text),e.seat._cphone=f._getDefaultPhoneNumber(),e.seat._idate=f._issue?f._issue.toFormatString("dd-mm-yyyy hh:ii"):"",e.seat._total=f._fare.toMn()+"đ",e.seat._status=f._getStatusText(),e.seat._suser=f._suser,f._isPaid()||f._isPass()){if(o=f._getPaymentInfo(),!$.isEmptyObject(o)){switch(o.type){case 1:case 6:typeof o.info!="undefined"&&(e.seat._pmInfo=o.info._code,e.seat._pmFullInfo="CN/ĐL:&nbsp;"+o.info._name);break;case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:e.seat._pmInfo=o.sname;e.seat._pmFullInfo=o.name}vIsEstStr(f._cuser)&&(e.seat._cuser=f._cuser)}}else f._isCancelled()&&(e.seat._cuser=f._getLastUpdateUser());e.seat._issue=f._issue?f._issue.getTime():""}i&&!app.oRights.StageEnable&&(k=$("<div />"),v=0,$.isEmptyObject(f)||(v=f._status));c=$(vtpl(_dict._ilTpl,e))}return c};S.prototype._getSeatInfo=function(){var n=this;return n._label+"|"+n._coach+"|"+n._row+"|"+n._col};S.prototype._getSeatId=function(){var n=this;return"seat_"+n._coach+"_"+n._row+"_"+n._col};S.prototype._getSeatType=function(){return this._type};S.prototype._addTicket=function(n,t,i){var r=this,u=r._tickets.push(n)-1,f=i?i:r._tickets[u].stageCode;f&t&&(r._currentTicketIndex=u);isNaN(f)||(r._seatStatus=r._seatStatus|f,(u==0||f>=r._tickets[r._tickets_idxMaxStageCode].stageCode)&&(r._tickets_idxMaxStageCode=u))};S.prototype._getCurrentTicket=function(n){var i=this,t;return i._currentTicketIndex==-1?{}:(t=i._tickets[i._currentTicketIndex],t&&t.stageCode&&n&&n>=1&&(n&t.stageCode)==0)?{}:t?t:{}};S.prototype._getTicketById=function(n){var i=this,t={};return $.each(i._tickets,function(i,r){$.isEmptyObject(t)&&r._id==n&&(t=r)}),t};S.prototype._changeStatus=function(n){this._status=n};S.prototype._isAvailable=function(){return this._status==1};S.prototype._isLock=function(){return this._status==2};S.prototype._hasTicket=function(){return this._tickets.length>0};S.prototype._clone=function(){var n=this;return $.extend({},n)};
//# sourceMappingURL=z.min.js.map
