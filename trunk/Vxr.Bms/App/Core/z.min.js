function vev(n,t,i,r){$(n).unbind(t).on(t,function(u){try{i&&i.call(r?r:this,u)}catch(f){console.error([n,t],f)}})}function vfe(n,t,i,r){try{var u=$.Event(t);u.d=i;r&&(u.cb=r);$(n).trigger(u)}catch(f){console.error([n,t,i],f)}}function vbf(n,t,i){vfe("body",n,t,i)}function vbv(n,t,i){vev("body",n,t,i)}function vce(n,t,i){vev(n,t,function(r){try{var u=$.Event(i);r.d&&(u.d=r.d);r.cb&&(u.cb=r.cb);$(n).trigger(u)}catch(f){console.error([n,t],f)}})}function vbe(n,t){vce("body",n,t)}function gDx(n){return $.dx||($.dx={}),$.dx[n.appId]||($.dx[n.appId]=[]),$.dx[n.appId]}function sDx(n){return $.dx||($.dx={}),$.dx[n.appId]=[],$.dx[n.appId]}function vConsole(n){app!=null&&app.status!=null&&app.status==0&&console.log(n)}function vRqs(n,t,i){var r={url:app.serviceUrl,type:"POST",contentType:"application/json; charset: utf-8",crossDomain:!0,data:JSON.stringify({obj:n}),headers:{CompId:app.cid,AgentId:app.aid,UserId:app.uid,UserName:app.un,csrf:app.csrf}};return i&&typeof i=="object"&&$.each(i,function(n,t){r[n]=t}),$.ajax(r).done(function(n){if(n=n.hasOwnProperty("d")?n.d:n,n.Result==0&&n.Expired==2){window.location.reload();return}if(n.Result==-10){alert("Bạn đang truy vấn quá nhiều, vui lòng nghỉ và nhâm nhi cafe.");window.location.reload();return}var i=n.TotalRecordCount?n.TotalRecordCount:0;n.Code!=null&&n.Code!=undefined&&(i=n.Code);t&&typeof t=="function"&&t.call(this,n.Result,n.Records,n.Records?n.Records.length:0,i,n.Message);n.Result||console.log("> rq: ",n.Result,n.Message)}).fail(function(n,t,i){console.error(t,i)})}function vRqr(n,t){return $.ajax({type:"POST",url:app.reportBaseUrl,crossDomain:!0,data:JSON.stringify({obj:n}),success:t,error:function(){alert("Error!")}})}function vRql(n,t,i){return vRqs(n,function(n,r,u,f){if(t.a&&t.a.call(i,n,r,u,f),t.m&&n&&u>0&&r&&r.length)for(var e=0;e<u;e++)t.m.call(i,e,r[e]);t.z&&t.z.call(i,n,r,u,f)})}function vRqu(n,t){var i=!1;if(oRq.iAc&&oRq.cAType==2)if(oRq.cRqs.indexOf(oRq.cKey)==-1){if(oRq.cRqs.push(oRq.cKey),oRq.cEl.length>0&&oRq.cLType>0)switch(oRq.cLType){case 1:$(oRq.cEl).attr("disabled",!0);break;default:$(oRq.cEl).attr("disabled",!0)}}else i=!0;return i?null:vRqs(n,t)}function vRqz(){if(oRq.cRqs.pop(oRq.cKey),oRq.iAc&&oRq.cAType==2&&oRq.cEl.length>0)switch(oRq.cLType){case 1:$(oRq.cEl).removeAttr("disabled");break;default:$(oRq.cEl).removeAttr("disabled")}oRq.iAc=!1;oRq.cEl=null;oRq.cLType=null;oRq.cKey=null}function eRqs(n,t,i){var r={url:app.serviceFrontUrl,type:"POST",contentType:"application/json; charset: utf-8",crossDomain:!0,data:JSON.stringify({objs:n}),headers:{CompId:app.cid,AgentId:app.aid,UserId:app.uid,UserName:app.un,csrf:app.csrf}};return i&&typeof i=="object"&&$.each(i,function(n,t){r[n]=t}),$.ajax(r).done(function(n){n=n.hasOwnProperty("d")?n.d:n;var i=n.TotalRecordCount?n.TotalRecordCount:0;n.Code!=null&&n.Code!=undefined&&(i=n.Code);t&&typeof t=="function"&&t.call(this,n.Result,n.Records,n.Records?n.Records.length:0,i,n.Message);n.Result||console.log("> rq: ",n.Result,n.Message)}).fail(function(n,t,i){console.error(t,i)})}function eRql(n,t,i){return eRqs(n,function(n,r,u,f){if(t.a&&t.a.call(i,n,r,u,f),t.m&&n&&u>0&&r&&r.length)for(var e=0;e<u;e++)t.m.call(i,e,r[e]);t.z&&t.z.call(i,n,r,u,f)})}function vGTrs(){var n=[];return $.each(oTrs,function(t,i){n.push({Id:i,Name:vGTrds(i)})}),n}function vGTrds(n){return n==oTrs.add?"Tăng cường":n==oTrs.cancel?"Hủy":n==oTrs.normal?"Kích hoạt":n==oTrs.waiting?"Mặc định":"Không biết"}function vToMn(n){return n=n==undefined?this:n,vToUStr(0,",",".",n)}function vToNum(n){return n=n==undefined?this:n,Number(n.replace(/[^0-9]+/g,""))}function vToUStr(n,t,i,r){r=r==undefined?this:r;typeof r=="string"&&(r=parseInt(r));n=isNaN(n=Math.abs(n))?2:n;t=t==undefined?".":t;i=i==undefined?",":i;var e=r<0?"-":"",f=parseInt(r=Math.abs(+r||0).toFixed(n))+"",u=(u=f.length)>3?u%3:0;return e+(u?f.substr(0,u)+i:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+i)+(n?t+Math.abs(r-f).toFixed(n).slice(2):"")}function vGln(n){var t="",i;if(n&&n.length>11){i=n.trim().split(" ");switch(i.length){case 1:t=i[0];break;case 2:t=i[1];break;case 3:t=i[2];break;case 4:t=i[3];break;case 5:t=i[4]}}else t=n;return t}function vGai(n){var t=n.indexOf("~"),i=n.substr(t+1,n.length).split("|");return i[0]}function vGsn(n){var t=n.split("~"),i=t[1].split("|");return parseInt(i[2])}function vGfa(n){var t=n.split("|");return vToMn(t[2])}function vGpp(n,t){var i="Version|Price~[FromRouteStopIndex|ToRouteStopIndex|Price|Unit|ConditionType|ConditionInfo~FromRouteStopIndex|ToRouteStopIndex|Price|Unit|ConditionType|ConditionInfo]".split("~"),r=n.split("~");if(t=="Price"){var u=i[0].split("|"),f=r[0].split("|"),e=_.indexOf(u,t);return vToMn(f[e])}return""}function vGtp(n,t){if(!n)return"";var r="Id~Version|TotalFloors|TotalSeats|Type|Code|Name|Note|CSS".split("~"),i=n.split("~");if(t=="Id")return i?parseInt(i[0]):"";var u=r[1].split("|"),f=_.indexOf(u,t),e=i[1].split("|");return e[f]}function vGvs(n,t,i,r){return app.mvs+"~"+n+"|"+t+"|"+i+"|"+r}function vGvp(n,t){var i,r;if(!n)return"";if(i=n.split("~"),i&&i.length>1&&(r=i[1].split("|"),r&&i.length>1)){if(t=="LicensePlate")return r[2];if(t=="Type")return r[1];if(t=="Id")return r[0]}return n}function vGas(n){var i=[],t,r,u;return n&&n.length>0&&(t=n.indexOf("~"),t>=0&&(n=n.substring(t+1),r=n.split("~"),$.each(r,function(n,t){u=vGdi(t,"|",0);i.push({Id:u,Name:vGdi(t,"|",3)})}))),i}function vGfs(n,t){var e=[],r,o,i,u,f,s,h;return t&&t.length>0&&(r=t.indexOf("~"),r>=0&&(t=t.substring(r+1),t&&t.length>0&&(o=t.split("~"),$.each(o,function(t,r){u=vGdi(r,"|",0);f=vGdi(r,"|",1);s=vGdi(r,"|",2);h=u+"|"+f;i={Code:h,FromArea:vGetObj({Id:u},n),ToArea:vGetObj({Id:f},n),Fare:s};i.FromArea&&i.ToArea&&e.push(i)})))),e}function vGpps(n){var t,i,r,u;return n==null?[]:(t=n.indexOf("~"),i=[],t>=0&&(n=n.substring(t+1),r=n.split("~"),$.each(r,function(n,t){u={PointId:vGdi(t,"|",0),PointName:vGdi(t,"|",1),PointTime:vGdi(t,"|",2),PointIndex:vGdi(t,"|",3),PointAddress:vGdi(t,"|",4),PointNearBy:vGdi(t,"|",5),PointLocaltionId:vGdi(t,"|",6)};i.push(u)})),i)}function vGmi(n,t){var i="";if(t=t.trim(),n.trim()==""||n.length==0)(t!=""||t.length>0)&&(i="|"+t);else switch(n.length){case 10:i=t!=""||t.length>0?n+"|"+t:n+"|";break;case 7:i=t!=""||t.length>0?"00-"+n+"|"+t:"00-"+n+"|";break;case 4:i=t!=""||t.length>0?"00-00-"+n+"|"+t:"00-00-"+n+"|"}return i}function vGma(n){var u;if(vIsEstStr(n)&&n!=""){var i="",r="",t=n.split("|");t[0].length==10?(u=t[0].split("-"),u[0]=="00"?u[1]=="00"?(i=u[2],r=t[1].trim()):(i=u[1]+"-"+u[2],r=t[1].trim()):(i=t[0],r=t[1].trim())):(i="",r=t[1].trim())}else i="",r="";return[i,r]}function vGtmp(n,t,i){var u,f,r;if(!n)return"";for(u=n.split("~"),f="",r=1;r<u.length;r++){var o=u[r],e=o.split("|"),s=e[0];s+""==t+""&&(f+=i?", "+e[1]:", "+e[2])}return f.substring(2)}function vGvl(n,t,i){if(!n)return"";var r=n.split(t);return r==null||i>=r.length?"":r[i]}function vGvo(n,t,i){var r,u,f;return n==null?"":(r=n.split("~"),r==null||r.length==0)?"":(u=r[t],f=u.split("|"),f[i])}function vGpi(n,t,i,r){return!i&&!r?"":n+"|"+t+"|"+i+"|"+r}function vGdi(n,t,i){if(!n)return"";var r=n.split(t);return i>=r.length?"":r[i]}function vIsNumKey(n){var t=n.which?n.which:n.keyCode;return t>=48&&t<=57||t>=96&&t<=105}function vIsPhone(n){var r,i,t,u;if(n=this==window?n:this,n=n.trim(),r=n.length,!n.match(/(^[0-9]*$)/g))return!1;if(_dict._hasByPassPhoneNumber!=undefined&&_dict._hasByPassPhoneNumber)return!0;if(r==10){if(i=n.substr(0,3),typeof _dict._pnp["10"]!="undefined"&&_dict._pnp["10"].indexOf(i)!=-1)return!0;if(typeof _dict._epnp!="undefined"&&typeof _dict._epnp["10"]!="undefined"){if(_dict._epnp["10"].indexOf(i)!=-1)return!0;for(t=0;t<_dict._epnp["10"].length;t++)if(_dict._epnp["10"][t].length==2&&i.substring(0,2)==_dict._epnp["10"][t])return!0}else return!1}else return r==11?(u=n.substr(0,4),_dict._pnp["11"].indexOf(u)!=-1?!0:typeof _dict._epnp!="undefined"&&typeof _dict._epnp["11"]!="undefined"&&_dict._epnp["11"].indexOf(u)!=-1?!0:!1):!1}function vIsPNum(n){return n.match(/[^0-9.+()\-\s]/g)==null}function vIsCurrency(n){return/^[1-9]\d*(?:\.\d{0,2})?$/.test(n)}function vIsPwd(n){var t=!0,i;return n=n.trim(),i=/\d/,n.length>=6&&n.length!=""?isNaN(n)?i.test(n)||(t=!1):t=!1:t=!1,t}function vIsVehiNum(n){var t;if(n.toLowerCase().match(/[^a-zA-Z0-9|.|\-|\s|à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ|è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ|ì|í|ị|ỉ|ĩ|ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ|ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ|ỳ|ý|ỵ|ỷ|ỹ|đ]/g)==null)if(n.toLowerCase().indexOf("-")!=-1)if(t=n.split("-"),t[1].length==6||t[1].length==4)switch(t[1].length){case 6:return t[1].indexOf(".")!=-1?t[1].match(/[^0-9|.]/g)==null:!1;case 4:return t[1].match(/[^\d]/g)==null}else return!1;else return!1;else return!1;return!1}function vLCss(n){$("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet"}).attr("href",n)}function vLJS(n,t){$.getScript(n).done(function(){t.call()}).fail(function(){})}function setAnimation(n,t,i){return n.css("-webkit-animation",t+" "+i+" ease-in-out").css("animation",t+" "+i+" ease-in-out"),n.css("-webkit-animation-fill-mode","forwards").css("animation-fill-mode","forwards"),n}function setVisibleToElement(n,t,i){return t?n.show(i):n.hide(i),n}function setEnableToElement(n,t){return t?n.removeClass("disabled"):n.addClass("disabled"),n}function getMasterCellFormat(n){return"<span class='vMasterRow'>"+n+"<\/span>"}function vtpl(n,t){return n.replace(/\{([\w\.]*)\}/g,function(n,i){for(var u=i.split("."),r=t[u.shift()],f=0,e=u.length;f<e;f++)r=r[u[f]];return typeof r!="undefined"&&r!==null?r:""})}function vChIco(n,t,i){n.hasSearchIco||(n.hasSearchIco=!0,t=t?t+" ":"",t=t+".chosen-choices li.search-field input",i||(i='<i class="glyphicon glyphicon-search"><\/i>'),$(i).insertBefore(t),$(t).val(n.emptyName))}function vUChIco(n,t){n.hasSearchIco&&(n.hasSearchIco=!1,t=t?t+" ":"",t=t+"ul.chosen-choices li.search-field",$(t).html('<input type="text" value="" class="default" autocomplete="on" style="width: 100%;">'))}function Vm(n){var t=n.view;return{_me:function(){var i=this,r;i.view=t;i.o=n;i.t=n.t;i.bCases={};i.bStops={};$.each(gDx(n),function(t,i){gDx(n)[i.name]=i});$.each(n.p,function(n,t){i[n]=t});r=vGetObj({gColType:"No"},gDx(n));r&&(i.xNo=r)},_close:function(){var i=this;$.each(n.p,function(n){i[n]=null});t.unbind();$.setUrlOnClick(app.bms.BksModule)},_reset:function(){var n=this;n.model={};n.mainModels=[];n.baseDetailModels=[]},_gSelect:function(t){var i=this,r;(!i.onSelectRow||(r=i.onSelectRow.call(i,t),r))&&(n.filterOnly||$.each(t.rs,function(n,t){i._loadItem(t);i._onSelectionChange(t)}))},_gDeselect:function(t){var i=this,r;(!i.onDeSelectRow||(r=i.onDeSelectRow.call(i,t),r))&&(n.filterOnly||(i._unloadItem(),i._onSelectionChange(null)))},_selectChosen:function(n,t,i){n.vals||(n.vals={});n.vals[$.trim(t)]=i},_deselectChosen:function(n,t){if(t=="*"){n.vals={};return}n.vals&&delete n.vals[$.trim(t)]},_reloadChosen:function(n,t){var i=this;vv.clearChosen(n.ref);$(n.ref).trigger("chosen:updated");n.e={};n.a={deselected:"*"};i.onChosenChange(n);t&&$.each(t.split(","),function(t,r){vv.chose(n.ref,parseInt(r));n.e={};n.a={selected:r};i.onChosenChange(n)});$(n.ref).trigger("chosen:updated")},_resetChosen:function(n){var t=$(n.ref);$("option",t).each(function(t){vv.unchose(n.ref,t);$(n.ref).trigger("chosen:updated")})},_beginForm:function(){var i=this;n.defaultFocusRef&&setTimeout(function(){t.find(n.defaultFocusRef).trigger("focus")},5e3)},_bindVal:function(n,t,i){var r=this;t.bVal&&(t.bType==null&&(t.bType="t"),t.bType=="t"&&r.t?t.bFx&&r.t[t.bFx]?r.t[t.bFx].call(r.t,i):r.t[t.bVal]=i:t.bFx&&r[t.bFx]?r[t.bFx].call(r,i):r[t.bVal]=i)},preventEvent:function(n,t){var i=this;i.bStops[n]=t},isCase:function(n){var t=this;return t.bCases[n]==!0},_applyCaseAndStop:function(n){var t=this;return(t.bCases={},t.bCases[n.name]=!0,t.bStops[n.name])?(t.bStops[n.name]=!1,!1):!0},_applyXChange:function(n,i){var r=this;t.find(i.ref).unbind("change").change(function(u){var f=$(this),e=f.val();$.vCacr(i.rights,function(){(r._bindVal(n,i,e),r._applyCaseAndStop(n,i))&&(typeof i.xChange=="function"?i.xChange.call(r,t,f,u):r[i.xChange]&&r[i.xChange].call(r,t,f,u))},r);typeof i.xChange!="function"&&r.logEvent(i.xChange,e)})},_applyXClick:function(n,i){var r=this,u="";u=i.ref?i.ref:n.ref;t.find(u).unbind("click").click(function(f){var e=$(this);t.find(u).prop("disabled",!0);$.vCacr(n.rights,function(){if(r._applyCaseAndStop(n,i)){var o=function(){t.find(u).prop("disabled",!1)};typeof i.xClick=="function"?i.xClick.call(r,e,i,o,f.target):r[i.xClick].call(r,e,i,o,f.target);t.find(u).prop("disabled",!1)}},r)})},isExistChosenVal:function(n,t){var i=!1,r=$(n.ref);return $("option",r).each(function(n,r){return r.value==t&&(i=!0),!1}),i},_applyXKey:function(n,i,r){var u=this,o="",f="",e;o=i.ref?i.ref:n.ref;vv.isChosen(n)&&(o=n.zRef);e=t.find(o);e.unbind(r)[r].call(e,function(o){var s=$(this);e.prop("disabled",!0);$.vCacr(n.rights,function(){var l,v,a,c,y,h;if(f=vv.isChosen(n)?e.find("input").val():e.val(),l=!1,v=i.bKeys?i.bKeys.split(","):[],$.each(v,function(n,t){parseInt($.trim(t))==o.which&&(l=!0)}),l||!i.bKeys){if(u._bindVal(n,i,f,o),!u._applyCaseAndStop(n,i))return;i.bAppend&&(a=[],c={},c[n.valField]=f,c[n.displayField]=f,a.push(c),y=u.isExistChosenVal(n,f),y||u.loadXCbb(n.name,a,f,!0,!0));h=r=="keyup"?i.xKeyup:i.xKeydown;typeof h=="function"?h.call(u,t,s,o,n,f):u[h]&&u[h].call(u,t,s,o,n,f);e.prop("disabled",!1)}},u)})},_applyXDateSelect:function(n){var i=this,r={dayNames:["CN","T2","T3","T4","T5","T6","T7"],changeMonth:!0,changeYear:!0,yearRange:"1950:2020",dateFormat:app.ddfm};n.listeners&&$.each(n.listeners,function(u,f){f.xDateSelect&&i[f.xDateSelect]&&(r.onSelect=function(t){var r=$(this),u=r.val();(i._bindVal(n,f,u),i._applyCaseAndStop(n,f))&&(typeof f.xDateSelect=="function"?f.xDateSelect.call(i,r,t):i[f.xDateSelect].call(i,r,t),typeof f.xDateSelect!="function"&&i.logEvent(f.xDateSelect,u))});f.xDateChange&&i[f.xDateChange]&&(r.onSelect=function(r){var u=$(this),e=u.val();(i._bindVal(n,f,e),i._applyCaseAndStop(n,f))&&(typeof f.xDateChange=="function"?f.xDateChange.call(i,t,u,r):i[f.xDateChange].call(i,t,u,r),typeof f.xDateChange!="function"&&i.logEvent(f.xDateChange,e))})});t.find(n.ref).datepicker(r)},_bindL:function(n){var i=this;n.vType=="money"&&t.find(n.ref).keyup(function(){var t=$(this);$.vCacr(n.rights,function(){t.val(vToMn(t.val().replace(/\./g,"")))})});n.type&&n.type.toLowerCase()=="date"&&i._applyXDateSelect(n);n.listeners&&$.each(n.listeners,function(t,r){r.ref||(r.ref=n.ref);r.xChange&&i._applyXChange(n,r);r.xClick&&i._applyXClick(n,r);r.xKeyup&&i._applyXKey(n,r,"keyup");r.xKeydown&&i._applyXKey(n,r,"keydown")})},_applyListeners:function(t){var i=this;typeof t!="undefined"&&t&&t.length>0?$.each(t,function(n,t){i._bindL(t);vv.isChosen(t)||i._initOptions(t)}):($.each(gDx(n),function(n,t){i._bindL(t);vv.isChosen(t)||i._initOptions(t)}),$.each(n.buttons,function(n,t){i._bindL(t);vv.isChosen(t)||i._initOptions(t)}))},_initOptions:function(i,r){var u=this,e,f;i.options&&i.listConfig&&!i.noAjax&&(e=i.listConfig.valField,f=i.listConfig.displayField,i.listConfig.ajax&&!i.listConfig.noload)&&(i.listConfig.ajax.getC&&(i.listConfig.ajax._c=u[i.listConfig.ajax.getC].call(u,i,i.listConfig.ajax._c)),u._requestModels(i.listConfig.ajax,function(o){i.options=[];t.find(i.ref).empty();typeof i.allowEmpty!="undefined"&&i.allowEmpty&&t.find(i.ref).append('<option value="">'+(i.emptyName?i.emptyName:"Chọn")+"<\/option>");$.each(o,function(n,r){var s=r[e],u="",o;f.indexOf(",")>0?(o=f.split(","),$.each(o,function(n,t){u=u+" "+r[t.trim()]}),u=u.trim()):u=r[f];i.options.push(r);t.find(i.ref).append('<option value="'+s+'">'+u+"<\/option>")});r&&r.call(u);i.listConfig.cb&&u[i.listConfig.cb].call(u,n,i,o)}))},_loadBaseData:function(i){var r=this,e,f,u;n.baseCf&&($("#"+n.gId).mask("Loading.........."),r.listBase=[],r.listArea=[],n.baseCf._f=r._getQueryFields(),e=n.baseCf._f.split(","),f=[],typeof _dict._hasBlockTripByBranch!="undefined"&&_dict._hasBlockTripByBranch&&typeof _dict._blockTripByBranch!="undefined"&&typeof _dict._blockTripByBranch[app.aid]!="undefined"&&($.each(_dict._blockTripByBranch[app.aid],function(n,t){f.push("$x != "+t)}),n.baseCf._c.Id=f.join(" and ")),r.onBeginLoadBaseData&&r.onBeginLoadBaseData.call(r,n,i),u=vGetObj({base:!0},gDx(n)),vRql(n.baseCf,{a:function(){$.each(gDx(n),function(n,i){i.base&&t.find(i.ref).empty()});u&&typeof u.allowEmpty!="undefined"&&u.allowEmpty&&t.find(u.ref).append('<option value="">'+(u.emptyName?u.emptyName:"Chọn")+"<\/option>")},m:function(i,f){var o={};$.each(e,function(t,i){i=="RouteInfo"&&n.gId!="tripTableContainer"&&(o.arrArea=vGas(f[t]));i=="FareInfo"&&(o.arrFare=vGfs(o.arrArea,f[t]));i=="PickedPointsInfo"&&(o.arrPkPoints=vGpps(f[t]));i=="TransferPointsInfo"&&(o.arrTfPoints=vGpps(f[t]));o[i]=f[t]});r.listBase.push(o);u&&$.vCheckAndAppendOptions(t.find(u.ref),o[u.baseValField],o[u.baseDisplayField],"R")},z:function(){r.onEndAjaxloadBaseData&&r.onEndAjaxloadBaseData.call(r);r._reset();$.each(gDx(n),function(n,i){i.base&&i.name.toLowerCase()!="pickuptime"&&t.find(i.ref).trigger("change")});i&&i.call(r)}},r),r.onEndloadBaseData&&r.onEndloadBaseData.call(r,n,i))},_getQueryFields:function(){for(var i="Id",t=0;t<gDx(n).length;t++)gDx(n)[t].gQuery&&(i+=","+gDx(n)[t].name);return i},_loadItem:function(i){var r=this;r.model=i;r.onBeginLoadItem&&r.onBeginLoadItem.call(r);$.each(gDx(n),function(n,u){var f,e,s,c,l;if(vv.isChosen(u)&&r._resetChosen(u),f=i[u.name],u.valField&&(f=i[u.valField]),u.type&&u.type.toLocaleLowerCase()=="date"&&(f=vGtDtObj("00:00",f),u.displayFormat&&(u.displayFormat=app.ddfm),f=vDtToStr(u.displayFormat,f)),u.gTextToFId){var o=!1,a=0,h="";$(u.ref+" option").each(function(){var n=$(this).val();$(this).text().trim().indexOf(f)!=0||o||(f=n,o=!0);n!=""&&n!=null&&(h=n);a++});o||(u.autoAppend?(e=f,s=f,u.appendText&&(s+=" - "+u.appendText),u.vType=="num"&&(e=parseInt(h)+1,f=e),$.vCheckAndAppendOptions(t,u.ref,e,s)):f="")}u.rootField&&(f=i[u.rootField]);u.rvc&&(f=r[u.rvc].call(r,u,f));u.fDisplay&&(f=u.fDisplay.call(null,f));u.combobox&&!u.formToGridOnly?(c=$(u.ref+" option"),$.each(c,function(n,t){if(t.text==f){l=t.value;return}}),$(u.ref+" option").prop("selected",!1).filter('[value="'+l+'"]').prop("selected",!0)):vv.isChosen(u)?r._reloadChosen(u,f):u.formToGridOnly?r.onLoadingField&&r.onLoadingField.call(r,u,i):t.find(u.ref).val(f)});r.onItemLoaded&&r.onItemLoaded.call(r,i);t.find("button.save").html('<i class="glyphicon glyphicon-save"><\/i> Lưu')},_getCondition:function(n){var r=this,i={};return n?($.each(n,function(n,u){if(!u)return!0;var f=t.find(u.ref).val();return u.useOptionTextAsVal&&(f=t.find(u.ref+" option:selected").text()),u.type=="Date"&&(f=vDtToStr("iso",vGtDtObj("00:00",f))),u.svb&&(f=r[u.svb].call(r,u,f)),vIsEstStr(f)&&f.toString().length>0&&(u.valField?i[u.valField]=f:u.rootField?i[u.rootField]=f:i[u.name]=f),!0}),i):i},_getAjaxConfig:function(t){var r=this,i={};return t&&$.each(t,function(n,t){i[n]=t}),n.queryConditions&&$.each(n.queryConditions,function(n,t){i[n]=t}),{_a:n.queryAction,_c:i,_f:r._getQueryFields()}},_getAjaxConfig2:function(t){var r=this,i={};return n.queryConditions&&$.each(n.queryConditions,function(n,t){i[n]=t}),t&&$.each(t,function(n,t){i[n]=t}),{_a:n.queryAction,_c:i,_f:r._getQueryFields()}},_getBaseModel:function(){var f=this,i=vGetObj({base:!0},gDx(n)),r,u;return i?(r=parseInt(t.find(i.ref).val()),u=vGetObj({Id:r},f.listBase),u):null},_getDetailModelsFromBase:function(i,r,u){var e=this,o=[];if(!i)return[];var f=vGetObj({xbase:!0},gDx(n)),h=i[f.baseValSrcField],s=[];return f.xchr&&(s=e[f.xchr].call(e,f,h)),$.each(s,function(s,h){var l={},c;return(l[f.name]=h,vGetObj(l,r))?!0:(c={Id:"New"+s},$.each(gDx(n),function(n,r){var o,s;return r.gQuery?(r.dType==1||(r.cpc?(o=t.find(r.ref).val(),u&&u[r.name]&&(o=u[r.name]),c[r.name]=e[r.cpc].call(e,r,i[r.name],o,h,i),r.type=="Date"&&(s=vGtDtObj("00:00",c[r.name]),c[r.name]=vDtToStr("dd-mm-yyyy",s))):c[r.name]=i[r.name],r.isBaseId&&(c[r.name]=i.Id)),r.name==f.name&&(c[r.name]=h),!0):!0}),o.push(c),!0)}),o},_applyFromBaseOptions:function(i){var r=this,u=vGetArr({fromBase:!0},!0,gDx(n));$.each(u,function(n,u){if(u.cbb&&u.fromExcludeCases&&u.fromExcludeCases.indexOf(i)<0&&(t.find(u.ref).empty(),u.xchv)){var f=r[u.xchv].call(r,r._getBaseModel(),r.mainModels);$.each(f,function(n,i){$.vCheckAndAppendOptions(t.find(u.ref),n,i,"R",!0)})}t.find(u.ref).trigger("change")})},_getD:function(t,i){var u=this,r={},o={},e=u._getBaseModel(),f="";return $.each(gDx(n),function(t,s){if(s.noSave||(f=u._gfv(s),s.valField?r[s.valField]=f:s.name&&(r[s.name]=f)),s.name&&(o[s.name]=s),s.auto){if(s.depends){var h={};$.each(s.depends,function(t,i){var r=vGetObj({name:i},gDx(n));h[i]=u._gfv(r)});s.needBase&&(h.Base=e);s.svc&&(f=u[s.svc].call(u,s,u._gfv(s),h,i))}s.name&&(r[s.name]=f)}s.gQuery&&s.copyFromBase&&s.name&&(r[s.name]=e[s.name])}),n.defaultData&&$.each(n.defaultData,function(n,t){r[n]=t=="$base"?e.Id:t}),t&&$.each(t,function(n,t){r[n]=t}),r},_gfv:function(n,i,r){var f=this,u;return!n||!n.ref?"":(u=t.find(n.ref).val(),n.defaultValue!=null&&u==undefined&&(u=n.defaultValue),n.useOptionTextAsVal&&(u=t.find(n.ref+" option:selected").text()),n.type!="Date"||i||(u=vDtToStr("iso",vGtDtObj("00:00",u))),vv.isChosen(n)&&n.vals?n.svc&&(u=f[n.svc].call(f,n,u,n.vals)):n.svc&&!n.depends&&(u=f[n.svc].call(f,n,u)),n.vType!="num"||n.useOptionTextAsVal||(u=parseInt(u)),r&&(u=r[n.name]),u)},_selectRowFromForm:function(){var r=this,i,e,u,f;r.stopGridSelectionEvent=!0;i=r._getMatchedRecords(r.mainModels,n.keyFields,!1,n.finalKeyFields,!0);i.length==0&&(i=r._getMatchedRecords(r.baseDetailModels,n.keyFields,!1,n.finalKeyFields,!0));e=$("#"+n.gId).jtable("getTotalRow");e>0&&(i.length==1?(u=$("#"+n.gId).jtable("getRowByKey",i[0].Id),u&&$("#"+n.gId).jtable("selectRows",u)):i.length==0?(f=$("#"+n.gId).jtable("selectedRows"),f.length>0&&$("#"+n.gId).jtable("deselectRows",f)):i.length>1&&$.each(i,function(t,i){var u=$("#"+n.gId).jtable("getRowByKey",i.Id);u&&(r.stopGridSelectionEvent=!0,$("#"+n.gId).jtable("selectRows",u))}));$.vCheckPopupRights(t);t.find(".closedStatus").trigger("change");return},_ajaxInsert:function(n,i,r,u){i.IsPrgStatus=1;var f=this;f.insertData=i;vRqs({_a:n,_f:"*",_d:i},function(n,i,e,o){n&&parseInt(i)>0?(vv.showMessage({element:t.find(".alert.message"),type:"alert-success",content:r+" thành công."}),FlatObj.FTripGetTrip=!1,$("#bksContent").vbooking("load"),u&&u.call(f,n,i,e,o)):vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:r+" thất bại, vui lòng thử lại sau."})})},_updateByInsert:function(t){var i=this,r=i._getD({StatusInfo:oTrs.normal},!0);i._ajaxInsert(n.insertAction,r,t+" "+n.name.toLocaleLowerCase(),function(){i._reloadMainData("New");n.afterUpdate&&n.afterUpdate.call(n)})},_ajaxUpdate:function(i,r,u,f,e,o){var h=this,s;r||(r=h._getD());var c="",l="",a="";r.BaseId!=undefined&&r.Date!=undefined&&r.Time!=undefined&&(c=r.BaseId,l=moment(r.Date).format("DD-MM-YYYY"),a=r.Time);s="";vRqs({_a:n.updateAction,_c:{Id:i},_d:r},function(n,r,u,v){n&&parseInt(r)>0?(s=e?e:"Cập nhật thành công.",vv.showMessage({element:t.find(".alert.message"),type:"alert-success",content:s})):(s=o?o:"Cập nhật thất bại, vui lòng thử lại sau.",vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:s}));FlatObj.FTripGetTrip=!1;vIsEstStr(c)?$("#bksContent").vbooking("load",{t:c,d:l,h:a}):$("#bksContent").vbooking("load");h._reloadMainData(i);f&&f.call(h,n,r,u,v)})},_onSelectionChange:function(i){var r=this;if(r.onBeginSelectionChange&&r.onBeginSelectionChange.call(r,t,i),$.each(gDx(n),function(n,u){var e=u.ref,f=!1;i&&i.StatusInfo==oTrs.cancel&&(f=!0);vv.isChosen(u)?(t.find(e).attr("disabled",f).trigger("chosen:updated"),i||r._resetChosen(u)):u.alwaysDisable||(u.alwaysEnable?f=!1:u.alwaysDisable&&(f=!0),t.find(e).prop("disabled",f),t.find(e).hasClass("departure")&&t.find(e).next().attr("disabled",f));!r.stopGridSelectionEvent&&i&&u.changeOnSelectionChange&&t.find(u.ref).trigger("change")}),r.stopGridSelectionEvent){r.stopGridSelectionEvent=!1;return}},_getMatchedRecords:function(t,i,r,u,f,e){var h=this,o={},s;return $.each(i,function(t,i){var r=vGetObj({name:i},gDx(n)),u=h._gfv(r,!0,e);r&&r.valField?o[r.valField]=u:o[i]=u}),s=vGetArr(o,!0,t),o={},(f||r&&s&&s.length>=1&&u)&&u&&$.each(u,function(t,i){var r=vGetObj({field:i},gDx(n)),u;if(r)u=h._gfv(r,!0,e),r.valField?o[r.valField]=u:o[i]=u,s=vGetArr(o,!0,s);else return s}),s},_unloadItem:function(){var n=this,t;n.model=null;t=$("#seat-map");t&&t.empty();n.onAfterUnloadItem&&n.onAfterUnloadItem.call(n)},_listAction:function(n,t,i,r){var f=this,o,s,u,h,e;if(f.isBeginLoad&&(t.jtStartIndex=0,f.isBeginLoad=!1),o=!0,n&&n.length&&n.length>0&&(o=!1),s=parseInt(t.jtStartIndex),t.jtStartIndex=i?0:s,t.jtPageSize=parseInt(t.jtPageSize),u=n,typeof f.o.gridSortBy!="undefined"&&(u=vSort(f.o.gridSortBy.Name,f.o.gridSortBy.IsDesc,u)),typeof f.o.gridCondition!="undefined"&&(u=vGetArr(f.o.gridCondition,!1,u)),typeof f.o.gridToBottom=="function"){for(h=u.filter(f.o.gridToBottom),e=0;e<u.length;e++)f.o.gridToBottom.call(f,u[e],e)&&(u.splice(e,1),e=0);u=u.concat(h)}return r?{Result:1,TotalRecordCount:o?t.jtStartIndex+t.jtPageSize:t.jtStartIndex+t.jtPageSize*2,Records:u,page:(t.jtStartIndex+t.jtPageSize)/t.jtPageSize}:{Result:1,TotalRecordCount:n.length,Records:u.slice(t.jtStartIndex,t.jtStartIndex+t.jtPageSize),page:(t.jtStartIndex+t.jtPageSize)/t.jtPageSize}},_getBaseDetailModels:function(t,i,r){var f=this,e=f._getBaseModel(),u=f._getDetailModelsFromBase(e,t,r);return f.baseDetailModels=u,i&&(u=vGetArr(i,gDx(n),u)),u},_reloadMainData:function(i,r,u,f,e){var o=this,s=vGetArr({domain:!0},!0,gDx(n));r||(r=o._getCondition(s));o._reloadTable(r,function(){var t,r,f;if(!e){if(!i){o._selectRowFromForm();return}i.indexOf&&(t=o._getMatchedRecords(o.mainModels,n.keyFields,!0,n.finalKeyFields,!0,o.insertData),i=t[0]?t[0].Id:"");r=$("#"+n.gId).jtable("getRowByKey",i);r&&$("#"+n.gId).jtable("selectRows",r);f=vGetObj({Id:i},o.mainModels);o._onSelectionChange(f,u);o._selectRowFromForm()}},function(n){o.mainModels=n;o._applyFromBaseOptions(u);$.vCheckPopupRights(t);var i=o._getBaseDetailModels(n,r,f);return($.each(n,function(n,t){i.push(t)}),o.getFinalExtRow)?o.getFinalExtRow.call(o,i):i})},_reload:function(t,i,r){var u=this,e,f;u.wkMasterModels=null;u.isBegin=!0;e=t?t._isOverride:null;e&&delete t._isOverride;u.onBeginReload&&u.onBeginReload.call(u);f=e?u._getAjaxConfig2(t):u._getAjaxConfig(t);$("#"+n.gId).mask("Loading..........");n.isRemotePagging?$("#"+n.gId).jtable("addLocalRecords",function(t,e,o){return f._c&&(f._c.pIdx=e.jtStartIndex,f._c.pSize=e.jtPageSize),u._requestModels(f,function(t){var f,s;r&&(t=r.call(u,t));f=u.isBegin;u.isBegin=!1;s=u._listAction(t,e,f,!0);o.Data=s;i&&i.call(u,t);u.afterReload&&u.afterReload.call(u,t);u.remoteModels=t;$("#"+n.gId).jtable("removeAllRows");$("#"+n.gId).unmask()})}):u._requestModels(f,function(t){r&&(t=r.call(u,t));$("#"+n.gId).jtable("removeAllRows");(typeof u.o.autoApplyGrid=="undefined"||u.o.autoApplyGrid==!0)&&$("#"+n.gId).jtable("addLocalRecords",function(n,i){var r=u.isBegin;return u.isBegin=!1,u._listAction(t,i,r)});i&&i.call(u,t);u.afterReload&&u.afterReload.call(u,t);u.remoteModels=t;$("#"+n.gId).unmask()})},_firstLoadTable:function(){var t=this;(t.onBeginFirstLoad&&t.onBeginFirstLoad.call(),n.grid&&!n.gNoLoad)&&t._reloadTable()},_reloadTable:function(t,i,r){var u=this;n.gRights?u._reload(t,i,r):u._reload(t,i,r)},_requestModels:function(i,r,u){var f=this,o=i._f.split(","),c=i._a,s=[],h=gDx(n),e={};return vRql(i,{a:function(t,i){e=$("#"+n.gId).jtable("getPageInfo");n.mainModel&&n.mainModel.Act==c&&(f.allData=i,f.advModels={})},m:function(t,i){if(u){var r=u.call(f,t);if(r){$.each(i,function(n,t){f._setMainModels(h,t,o,s,n,e)});return}}n.mainModel&&n.mainModel.Act==c?n.mainModel.Idx==t?$.each(i,function(n,t){f._setMainModels(h,t,o,s,n,e)}):n.mainModel[t]&&(f.advModels[t]=[],$.each(i,function(n,i){f._setMainModels(h,i,o,f.advModels[t],n,e)})):f._setMainModels(h,i,o,s,t,e)},z:function(){r&&r.call(f,s)}},f,t)},_setMainModels:function(n,t,i,r,u,f){var o=this,e={};$.each(i,function(i,r){var u,f;e[$.trim(r)]=t[i];u=n[$.trim(r)];t[i]==null&&u&&u.defaultValue&&(e[$.trim(r)]=u.defaultValue);u&&u.type&&u.type.toLowerCase()=="date"&&(u.displayFormat&&(u.displayFormat=app.ddfm),f=vDtToStr(u.displayFormat,vGtDtObj("00:00",t[i])),e[$.trim(r)]=f)});o.xNo&&(e[o.xNo.name]=u+1+parseInt(f?f.jtStartIndex:0));r.push(e)},_getOptions:function(n){var i=$(n),t=[];return $.each(i,function(){var n=$(this).text(),i=n.split("-");t.push(i[0].trim())}),t},_applyCondition:function(n,t,i,r){var u=this;$.each(n,function(n,f){f.name==t&&(i[r]=u._gfv(f))})},_onBasicUpdate:function(i,r){var u=this,e="",f=[],o=!0,c=parseInt($("#"+n.gId+" .jtable-page-size-change select").val()),s,h;$.each(gDx(n),function(n,i){var s,r=t.find(i.ref).val(),h;i.svv&&typeof i.svv=="string"&&(s=u[i.svv].call(u,i,r),s&&(o=!1,e+="\n"+s,f.push(i)));i.vtype=="money"&&(r=r.toNum());i.vtype=="num"&&isNaN(r)&&(o=!1,e+="\n"+i.label+" phải là số",f.push(i));i.vtype!="phone"||vIsPNum(r)||(o=!1,e+="\nSố điện thoại không hợp lệ.",f.push(i));i.vtype!="licensePlate"||vIsVehiNum(r)||(o=!1,e+="\nBiển số xe không hợp lệ.",f.push(i));i.required&&(r==""||r.trim().length<=0)&&(o=!1,e+="\n Vui lòng nhập "+i.label.toLocaleLowerCase(),f.push(i));i.name=="Username"&&(h=r.match(r.match(/[A-Z]+/)),h!=null&&h.length>0&&(o=!1,e+="\n Tên tài khoản không được chứa ký tự in hoa. Vui lòng nhập lại !",f.push(i)))});o?(i?(h=u._getD(null,!1),s={_a:n.updateAction,_c:{Id:u.model.Id},_d:h}):(h=u._getD(null,!0),s={_a:n.insertAction,_c:{},_d:h},s._d.IsPrgStatus=1,delete s._d.Id),vRqs(s,function(r){r?(u.onActionComplete&&u.onActionComplete.call(u),vv.showMessage({element:t.find(".alert.message"),type:"alert-success",content:"Thao tác thành công."}),u.onUpdateSuccess?u.onUpdateSuccess.call(u,i):u._reloadTable(null,function(){if(i&&!n.deselectAfterUpdate){var r=$("#"+n.gId).jtable("getRowByKey",i);r&&$("#"+n.gId).jtable("selectRows",r)}vv.clearFormAndGrid(t);$("#"+n.gId+" .jtable-page-size-change select").val(c)},null)):vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:"Thao tác thất bại, vui lòng thử lại sau."})})):(vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:e}),f.length>0&&t.find(f[0].ref).trigger("focus"));r&&typeof r=="function"&&r.call()},load:function(){var n=this;n._me();n._reset();n._applyListeners();n._loadBaseData();n._firstLoadTable();n._beginForm();n.onVMLoaded&&n.onVMLoaded.call(n)},bind:function(){var n=this;t.on("gSelect",function(t){n._gSelect(t)});t.on("gUnSelect",function(t){n._gDeselect(t)})},onGetData:function(n){var t=this;t._initOptions(n,function(){$(n.ref).trigger("chosen:updated")})},onViewReady:function(){var n=this;n.afterViewReady&&n.afterViewReady.call(n)},onChosenChange:function(n){var t=this;n.a&&(n.a.selected&&t._selectChosen(n,n.a.selected,vGetObj({Id:parseInt(n.a.selected)},n.options)),n.a.deselected&&t._deselectChosen(n,n.a.deselected))},close:function(){var n=this;n._close()},onClickSBF:function(){try{var n=this,t=$.sbf,i=n._getCondition(t.vals);n._reloadMainData(n.model?n.model.Id:null,i,"sbf")}catch(r){console.log("clickSBF",r)}},onChangeSBF:function(){var t=this,n=$.sbf;n.a&&(n.a.selected&&t._selectChosen(n,n.a.selected,vGetObj({Id:parseInt(n.a.selected)},n.options)),n.a.deselected&&t._deselectChosen(n,n.a.deselected))},onSave:function(){var i=this,r="",u;i.model&&(r=i.model.Id);u=function(){var u,f;r&&!r.indexOf?(f=!0,u=i._getMatchedRecords(i.mainModels,n.keyFields,!1,n.finalKeyFields,!0),u.length>=1?($.each(u,function(n,t){parseInt(t.Id)!=parseInt(r)&&(f=!1)}),f?i._ajaxUpdate(r):vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:"Chuyến đã tồn tại, vui lòng chọn Bus khác"})):i._ajaxUpdate(r)):r?(u=i._getMatchedRecords(i.mainModels,n.keyFields,!1,n.finalKeyFields),u.length==1?i._ajaxUpdate(u[0].Id):u.length>1?vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:"Chuyến đã tồn tại, vui lòng chọn Bus khác"}):i._updateByInsert("Cập nhật")):vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:"Vui lòng chọn "+n.name})};i.checkAndSave?i.checkAndSave.call(i,u):u.call()},onBasicSave:function(n,t,i){var r=this,u="";r.model&&(u=r.model.Id);u&&!u.indexOf?r._onBasicUpdate(u,i):r._onBasicUpdate(null,i)},onBasicDelete:function(i,r,u,f,e){var o=this,c=vGetObj({name:"btnRemove"},n.buttons),s=0,h;o.remoteModels&&$.each(o.remoteModels,function(n,t){t.Id==o.model.Id&&(s=n)});h={IsPrgStatus:3};e&&$.extend(h,e);vRqs({_a:n.updateAction,_c:{Id:o.model.Id},_d:h},function(n){n?(o.onActionComplete&&o.onActionComplete.call(o),vv.showMessage({element:t.find(".alert.message"),type:"alert-success",content:"Xóa thành công."}),vv.clearFormAndGrid(t),t.find("button.delete").addClass("btn-disabled").attr("disabled","disabled"),o._reloadTable(null,function(n){s>=n.length-1&&(s=0)})):vv.showMessage({element:t.find(".alert.message"),type:"alert-danger",content:c?c.messErro:"Thao tác thất bại, vui lòng thử lại sau."})})},onBasicClear:function(){var i=this;i.model=null;t.find("button.delete").addClass("btn-disabled").attr("disabled","disabled");vv.clearFormAndGrid(t);n.defaultFocusRef&&t.find(n.defaultFocusRef).trigger("focus")},getOverrideAjaxConfig:function(n,t){var r,i;return t&&t._a?t:(r=n._c,i={},r&&$.each(r,function(n,t){i[n]=t}),t&&$.each(t,function(n,t){i[n]=t}),{_a:n._a,_c:i,_f:n._f})},_clearCbb:function(i){var r=vGetObj({name:i},gDx(n)),u=t.find(r.ref);r&&(u.empty(),u.append('<option value="">'+(r.emptyName?r.emptyName:"Chọn")+"<\/option>"))},loadXCbb:function(i,r,u,f,e){var h=this,o,s;if((!h.isCase(i)||f)&&r&&r.length>0){if(o=vGetObj({name:i},gDx(n)),s=t.find(o.ref),!o)return;o.options=r;e||s.empty();$.each(o.options,function(n,t){$.vCheckAndAppendOptions(s,t[o.valField],t[o.displayField],"R")});vv.isChosen(o)&&(h._resetChosen(o),u!=null&&(s.val(u),s.trigger("chosen:updated")))}},_loadCbb:function(i,r,u){var e=this,f=vGetObj({name:i},gDx(n)),o=t.find(f.ref),s,h;if(f){if(f.local){o.empty();o.append('<option value="">'+(f.emptyName?f.emptyName:"Chọn")+"<\/option>");$.each(f.options,function(n,t){$.vCheckAndAppendOptions(o,t[f.valField],t[f.displayField],"R")});vv.isChosen(f)&&e._resetChosen(f);u&&u.call(e);return}(f.options=[],o.empty(),f.listConfig&&f.listConfig.ajax)&&(s=f.listConfig.ajax._f.split(","),h=e.getOverrideAjaxConfig(f.listConfig.ajax,r),vRql(h,{a:function(){o.empty();f&&typeof f.allowEmpty!="undefined"&&f.allowEmpty&&o.append('<option value="">'+(f.emptyName?f.emptyName:"Chọn")+"<\/option>")},m:function(n,t){var i={};$.each(s,function(n,r){i[$.trim(r)]=t[n]});$.vCheckAndAppendOptions(o,i[f.listConfig.valField],i[f.listConfig.displayField],"R")},z:function(){vv.isChosen(f)&&e._resetChosen(f);u&&u.call(e)}},e),e.onEndloadBaseData&&e.onEndloadBaseData.call(e,n,u))}},resetChosenByName:function(n,t,i){var f=this,r=vGetObj({name:n},gDx(f.o)),u;r&&(u=$(r.ref),t?(u.empty(),u.trigger("chosen:updated")):$("option",u).each(function(n){vv.unchose(r.ref,n);u.trigger("chosen:updated")}),i&&r.beginOptions&&($.each(r.beginOptions,function(n,t){$.vCheckAndAppendOptions(u,t[r.valField],t[r.displayField],"R");u.trigger("chosen:updated")}),f._reloadChosen(r)))},clearGrid:function(){$("#"+n.gId).jtable("removeAllRows")},logEvent:function(t,i){n.isDebug&&console.log(t,i?i:"")},removeChildRows:function(){var i=this,u="#"+n.gId,t=$(u).jtable("getDeselectedId"),r;i.wkMasterModels&&t&&(r=i.wkMasterModels[t],r&&(i.wkMasterModels[t]=null,$(u).jtable("delRecords",t,r)))},removeChildRow:function(t){var i=this,u,r;i.wkMasterModels&&(u="#"+n.gId,t&&(r=i.wkMasterModels[t],r&&(i.wkMasterModels[t]=null,$(u).jtable("delRecords",t,r))))},addChildRows:function(n,t){var i=this,r="#"+i.o.gId;if(i.wkMasterModels||(i.wkMasterModels={}),i.wkMasterModels[n]!=null){i.removeChildRow(n);return}i.logEvent("onSelectRow",t);i._requestModels(t,function(t){i.wkMasterModels[n]=t;$(r).jtable("insertRecords",n,t,"vSubRows")})},setHtml:function(n,t,i){var u=this,r;n=u.getMyRef(n);r=$.html(t,i);$(n).html(r)},getMyRef:function(t){return n.id&&t.indexOf(n.id)<0?"#"+n.id+" "+t:t}}}function vGetUni(n){var i,r,t,f,u;for(n=this==window?n:this,i={},r=[],t=0,f=n.length;t<f;++t)(u=JSON.stringify(n[t]),i.hasOwnProperty(u))||(r.push(n[t]),i[u]=1);return r}function vCln(n,t){t=this==window?t:this;for(var i=0;i<t.length;i++)t[i]==n&&(t.splice(i,1),i--);return this}function vNumEstIt(n){var i,t;for(n=this==window?absolute:this,i=0,t=0;t<n.length;t++)typeof n[t]!="undefined"&&i++;return i}function vFindById(n,t){var i=null;return t=this==window?t:this,$.each(t,function(t,r){return n==r.Id?(i=r,!1):!0}),i}function vSort(n,t,i){function r(n){var t=[],o=0,u=-1,f=0,i,e,r;try{while(i=(e=n.charAt(o++)).charCodeAt(0))r=i==46||i>=48&&i<=57,r!==f&&(t[++u]="",f=r),t[u]+=e;return t}catch(s){return t}}return(i=this==window?i:this,!t)?i.sort(function(t,i){var o,s,f,e,u,h,c;if(n){if(o=t[n],s=i[n],o&&s){if(isNaN(o)||isNaN(s)){for(f=r(o),e=r(s),u=0;f[u]&&e[u];u++)if(f[u]!==e[u])return h=Number(f[u]),c=Number(e[u]),h==f[u]&&c==e[u]?h-c:f[u]>e[u]?1:-1;return f.length-e.length}return parseInt(o)-parseInt(s)}return o?1:-1}return t<i?1:-1}):i.sort(function(t,i){var o,s,f,e,u,h,c;if(n){if(o=t[n],s=i[n],isNaN(o)||isNaN(s)){for(f=r(o),e=r(s),u=0;f[u]&&e[u];u++)if(f[u]!==e[u])return h=Number(f[u]),c=Number(e[u]),h==f[u]&&c==e[u]?c-h:f[u]>e[u]?-1:1;return e.length-f.length}return parseInt(s)-parseInt(o)}return t<i?1:-1})}function vGetArr(n,t,i){if(i=this==window?i:this,t!=undefined&&t){var r=[];return $.each(i,function(i,u){var f=!0;$.each(n,function(n,i){var e=t[n],r=u[n];e&&(e.type=="Date"&&(r.indexOf("/Date(")==0&&(r=vGetDateOnly(vGtDtObj(null,r))),i.indexOf("T")>0&&(i=vGetDateOnly(new Date(i)))),e.vType!="num"||e.useOptionTextAsVal||(i=parseInt(i),r=parseInt(r)));i!=r&&(f=!1)});f&&r.push(u)}),r}return _.where(i,n)}function vGetSearchCondt(n){if(n=this==window?n:this,!n)return"$x like '%'";var t="(",i=n.length-1;return $.each(n,function(n,r){t+="$x like '%|"+r+"|%'";n<i&&(t+=" or ")}),t+=")"}function vJoin(n,t){var i="";return t||(t=""),$.each(n,function(n,r){i=i+t+r}),i}function vSaveDate(n){var t=n.split("-");return t[2]+"-"+t[1]+"-"+t[0]}function vDtToStr(n,t){function i(n){var t=String(n);return t.length===1&&(t="0"+t),t}var c;if(t=this==window?t:this,t==null||typeof t=="undefined")return"";var r="",u=t.getDate(),f=t.getMonth()+1,e=t.getFullYear(),o=t.getHours(),s=t.getMinutes(),h=t.getSeconds();switch(n){case"dd-mm-yyyy hh:ii":r=i(u)+"-"+i(f)+"-"+e+" <b>"+i(o)+":"+i(s)+"<\/b>";break;case"dd/mm/yyyy":r=i(u)+"/"+i(f)+"/"+e;break;case"dd-mm-yyyy":r=i(u)+"-"+i(f)+"-"+e;break;case"iso":r=e+"-"+i(f)+"-"+i(u)+"T"+i(o)+":"+i(s)+":00.000";break;case"hh:mm":r=i(o)+":"+i(s);break;case"hh.mm":r=i(o)+"."+i(s);break;case"dd.mm.yyyy":r=i(u)+"."+i(f)+"."+e;break;case"HH:mm - dd.mm.yyyy":r=i(o)+":"+i(s)+" - "+i(u)+"."+i(f)+"."+e;break;case"HH:mm-dd.mm.yyyy":r=i(o)+":"+i(s)+" - "+i(u)+"."+i(f)+"."+e;break;case"HH:mm dd.mm.yyyy":r=i(o)+":"+i(s)+" "+i(u)+"."+i(f)+"."+e;break;case"DD dd-mm-yyyy":c=["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ 6","Thứ 7"][t.getDay()];r=c+" "+i(u)+"-"+i(f)+"-"+e;break;case"yyyy/mm/dd":r=e+"/"+i(f)+"/"+i(u);break;case"yyyy-mm-dd":r=e+"-"+i(f)+"-"+i(u);break;case"yyyy-mm-dd hh:mm:ss":r=e+"-"+i(f)+"-"+i(u)+" "+i(o)+":"+i(s)+":"+i(h);break;case"hh:mm:ss":r=i(o)+":"+i(s)+":"+i(h);break;case"sql":r=i(f)+"-"+i(u)+"-"+e+" "+i(o)+":"+i(s);break;case"dd-mm-yy":r=i(u)+"-"+i(f)+"-"+e;break;default:r=""}return r}function vAddMinutes(n,t){t=this==window?t:this;var i=t.getMinutes();return t.setMinutes(i+n),t}function vGetDateOnly(n){if(n=this==window?n:this,!n)return"";var t=n.getDate(),i=n.getMonth()+1,r=n.getFullYear();return t.toString().length==1&&(t="0"+t),i.toString().length==1&&(i="0"+i),t+"-"+i+"-"+r}function vAddTime(n,t){return t=this==window?t:this,t.replace("00:00",n)}function vPrsTm(n){if(n=this==window?n:this,n){var r=n.Hours,u=n.Minutes,t=r.toString(),i=u.toString();return r.toString().length==1&&(t="0"+t),u.toString().length==1&&(i="0"+i),t+":"+i}return""}function vGetNow(){var i=new Date,n=i.getDate(),t=i.getMonth()+1,r=i.getFullYear();return n<10&&(n="0"+n),t<10&&(t="0"+t),n+"-"+t+"-"+r}function vGtDptTm(n,t){var i=$.trim((null!=n?n:"")+" "+(null!=t?t:"")),r=new Date;return""!=i&&(r=vPrsDt(i)),r}function parseDateFromTString(n){return n!=null?new Date(parseInt(n.substring(n.indexOf("(")+1).replace(")/",""))):""}function formatDatepicker(n,t){return n.val()==""?"":moment(new Date(n.datepicker("getDate"))).format(t)}function vGetObj(n,t){if(t=this==window?t:this,t){var i=_.where(t,n);return i[0]}return{}}function vCloneObj(n){n=this==window?n:this;var t={};return n&&$.each(n,function(n,i){t[n]=i}),t}function vRdm(n){return n=this==window?n:this,n=n.toLowerCase(),n=n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),n=n.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),n=n.replace(/ì|í|ị|ỉ|ĩ/g,"i"),n=n.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),n=n.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),n=n.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),n=n.replace(/đ/g,"d"),n=n.replace(/!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'| |\"|\&|\#|\[|\]|~|$|_/g,"-"),n=n.replace(/-+-/g,"-"),n.replace(/^\-+|\-+$/g,"")}function vRdm2(n){return n=this==window?n:this,n=n.toLowerCase(),n=n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),n=n.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),n=n.replace(/ì|í|ị|ỉ|ĩ/g,"i"),n=n.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),n=n.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),n=n.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),n.replace(/đ/g,"d")}function vPrsDt(n){try{if(n=this==window?n:this,n==null)return moment((new Date).toString(),"Asia/Ho_Chi_Minh");if(n.indexOf("Date")>=0)return new Date(parseInt(n.substr(6),10));if(n.length==10){if(n.indexOf("-")==2||n.indexOf("."))return new Date(parseInt(n.substr(6,4),10),parseInt(n.substr(3,2),10)-1,parseInt(n.substr(0,2),10),0,0,0);if(n.indexOf("-")==4)return new Date(parseInt(n.substr(0,4),10),parseInt(n.substr(5,2),10)-1,parseInt(n.substr(8,2),10),0,0,0)}else{if(n.length==19)return new Date(parseInt(n.substr(0,4),10),parseInt(n.substr(5,2),10)-1,parseInt(n.substr(8,2,10)),parseInt(n.substr(11,2),10),parseInt(n.substr(14,2),10),parseInt(n.substr(17,2),10));if(n.length==16)return new Date(parseInt(n.substr(6,4),10),parseInt(n.substr(3,2),10)-1,parseInt(n.substr(0,2,10)),parseInt(n.substr(11,2),10),parseInt(n.substr(14,2),10),0);if(n.length==23)return new Date(parseInt(n.substr(0,4),10),parseInt(n.substr(5,2),10)-1,parseInt(n.substr(8,2),10),parseInt(n.substr(11,2),10),parseInt(n.substr(14,2),10),parseInt(n.substr(17,2),10))}return null}catch(i){return null}}function vGtDtObj(n,t){var i,r;return t=this==window?t:this,t==null&&(t=""),i=new Date,t.indexOf("T")<0?(r=$.trim(t+" "+(null!=n?n:"")),""!=r&&(i=vPrsDt(r)),i):new Date(t)}function vIsEstStr(n){return(n=this==window?n:this,typeof n!="undefined"&&n!=null&&n!="")?!0:!1}function vIsMulPhoneNum(n){var i,t;if(n=this==window?n:this,this.trim().length==0)return!0;if(this.indexOf("-")!=-1){for(i=this.split("-"),t=0;t<i.length;t++)if(i[t]==null||!vIsPhone(i[t]))return!1}else return isNaN(this)?!1:vIsPhone(this.trim());return!0}function vHasSpecChar(n){return n=this==window?n:this,n.toLowerCase().match(/[^a-zA-Z0-9|\s|+|.|\-|,|/|(|)|à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ|è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ|ì|í|ị|ỉ|ĩ|ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ|ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ|ỳ|ý|ỵ|ỷ|ỹ|đ]/g)!=null?!0:!1}function vHashCode(n){var t,i,r,u;if(n=this==window?n:this,t=0,n.length==0)return t;for(i=0,r=n.length;i<r;i++)u=n.charCodeAt(i),t+=u;return t}function replaceUnicodeCharacter(n){return n==null||n==""?"":n.toLowerCase().replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y").replace(/đ/g,"d").replace(/^\-+|\-+$/g,"")}function getSubItem(n,t,i){if(n==null)return"";try{return n.split(t)[i]}catch(r){return""}}function vEscapeSearchString(n){return n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a").replace(/Đ/g,"D").replace(/đ/g,"d").replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y").replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u").replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ.+/g,"o").replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ.+/g,"e").replace(/ì|í|ị|ỉ|ĩ/g,"i")}function Pager(n,t,i,r,u){Pager.prototype.totalRecords=n;Pager.prototype.totalPage=Math.ceil(n/t);Pager.prototype.itemsPerPage=t;Pager.prototype.currentPage=1;Pager.prototype.container=i;Pager.prototype.numberOfPageToBeShown=r;Pager.prototype.onPageChanged=u;var f=1-r/2>0?1-r/2:1;Pager.prototype.startButton=f;Pager.prototype.endButton=f+r<=n?f+r:n}var oAio=[{toMn:vToMn},{toNum:vToNum,rdm:vRdm,prsDt:vPrsDt,gDtObj:vGtDtObj,isExist:vIsEstStr,isPhone:vIsPhone,isMulPhone:vIsMulPhoneNum,hasSpecChar:vHasSpecChar,hashCode:vHashCode},{cln:vCln,findById:vFindById,sortArr:vSort,gtArr:vGetArr,numEstIt:vNumEstIt,getUnique:vGetUni,getSearchCondition:vGetSearchCondt},{toFormatString:vDtToStr,addMinutes:vAddMinutes,gDateOnly:vGetDateOnly,addTime:vAddTime,parseTime:vPrsTm}],oRc,cachedDemoRights,oRq,vv;$.each(oAio,function(n,t){var i=null;switch(n){case 0:i=Number;break;case 1:i=String;break;case 2:i=Array;break;case 3:i=Date;break;case 4:i=Object}i&&$.each(t,function(n,t){i.prototype&&(i.prototype[n]=t)})});$.rights={mdAg:{val:"2|2|1",dtr:""},mgmt:{val:"",dtr:""},mTrip:{val:"",dtr:""},mTrip_eiad:{val:"2|1104|1",dtr:""},mTrip_upPsIf:{val:"",dtr:"S11051"},mTrip_addTrip:{val:"",dtr:"S11031"},mTrip_saveTrip:{val:"",dtr:"S11011"},mTrip_rmvTrip:{val:"",dtr:"S11021"},mArea:{val:"",dtr:""},mArea_showAllArea:{val:"2|1201|1",dtr:"S12010"},mComp:{val:"",dtr:""},mComp_olUp:{val:"",dtr:"S13010"},mComp_edtDel:{val:"",dtr:"S13020"},mAgent:{val:"",dtr:""},mEmpl:{val:"",dtr:""},mAcc:{val:"",dtr:""},mRole:{val:"",dtr:""},mRole_add:{val:"",dtr:""},mRole_edrm:{val:"",dtr:""},mStpl:{val:"",dtr:""},mRoute:{val:"",dtr:""},mTicConf:{val:"",dtr:""},mTicConf_comp:{val:"",dtr:"S20010"},mTicConf_hv:{val:"2|2002|1",dtr:""},mTicConf_onl:{val:"2|2003|1",dtr:""},mTicConf_ofl:{val:"2|2004|1",dtr:""},mFare:{val:"",dtr:""},mFare_cfOnlFare:{val:"1|2101|1",dtr:"S21010"},mFare_cfFare:{val:"1|2102|1",dtr:"S21020"},mVerhicle:{val:"",dtr:""},mDrive:{val:"",dtr:""},mAssistant:{val:"",dtr:""},mGuide:{val:"",dtr:""},mCus:{val:"",dtr:"S30000"},mPickup:{val:"",dtr:""},mCusPrf:{val:"",dtr:""},mInitNewBo:{val:"1|2900|1",dtr:"S29000"},report:{val:"",dtr:""},rAllRpt:{val:"4021",dtr:""},rRp1:{val:"4001",dtr:""},rRp2:{val:"4002",dtr:""},rRp3:{val:"4003",dtr:""},rRp4:{val:"4004",dtr:""},rRp5:{val:"4005",dtr:""},rRp6:{val:"4006",dtr:""},rRp7:{val:"4007",dtr:""},rRp8:{val:"4008",dtr:""},rRp9:{val:"4009",dtr:""},rRp10:{val:"4010",dtr:""},rRp11:{val:"4011",dtr:""},rRp12:{val:"4012",dtr:""},rRp13:{val:"4013",dtr:""},rRp14:{val:"4014",dtr:""},rRp61:{val:"4061",dtr:""},booking:{val:"",dtr:""},bUBlockBks:{val:"2|5001|1",dtr:""},bEnStgTic:{val:"2|5002|1",dtr:""},bBook:{val:"1|5003|1",dtr:""},bUpdate:{val:"1|5004|1",dtr:""},bQBook:{val:"2|5005|1",dtr:""},bCancel:{val:"1|5006|1",dtr:""},bMove:{val:"1|5007|1",dtr:""},bQPay:{val:"2|5024|1",dtr:""},bDpt:{val:"1|5009|1",dtr:""},bTK:{val:"1|5025|1",dtr:""},bPPhoi:{val:"",dtr:""},bSPhoi:{val:"",dtr:""},bEdtAtCphoi:{val:"2|5012|1",dtr:""},bEdtOnlTic:{val:"2|5013|1",dtr:""},bBookPastTk:{val:"2|5014|1",dtr:""},bBkAtDpt:{val:"2|5015|1",dtr:""},bClAtDpt:{val:"",dtr:""},bClAtPm:{val:"",dtr:""},bEdtInfPaidTk:{val:"2|5018|1",dtr:""},bEnBtnAtDpt:{val:"2|5019|1",dtr:""},bAddMoreTk:{val:"1|5020|1",dtr:""},bPrtTk:{val:"1|5021|1",dtr:""},bReturn:{val:"1|5022|1",dtr:""},bUBFrtStg:{val:"2|5023|1",dtr:""},mgTrip:{val:"1|8000|1",dtr:""},codManager:{val:"",dtr:"S8800"},deaccount:{val:"1|1601|1",dtr:"S16010"},watchRoutes:{val:"1|10066|1",dtr:"S100660"},tripDriver:{val:"1|10064|1",dtr:"S100640"},hbookingbyDate:{val:"1|10063|1",dtr:""},cReDeFo:{val:"1|10067|1",dtr:""},bMoOl:{val:"1|10068|1",dtr:""},bUpOl:{val:"1|10069|1",dtr:""},bUnPr:{val:"1|10070|1",dtr:""},mPhoiManager:{val:"",dtr:"S110000"}};oRc={Stage:"5|10069|1"};cachedDemoRights={};$.userArrRights=[];$.compArrRights=[];$.rightsAction={0:"hide",1:"disabled"};$.vCacr=function(n,t,i){var u,f,r;if(!n&&t){t.call(i);return}for(u=!0,f=!0,r=0;r<$.userArrRights.length;r++)if($.userArrRights[r].id==n){u=$.userArrRights[r].status;break}for(r=0;r<$.compArrRights.length;r++)if($.compArrRights[r].id==n){f=$.compArrRights[r].status;break}u&&f&&t.call()};$.vPrpRgts=function(n){var t=null,i={};return t=n?n.find(".rights"):$(".rights"),$.each(t,function(n,t){var r=t.dataset.rights.length,o=t.dataset.rights.substring(0,1),u=t.dataset.rights.substring(1,r-1),e=t.dataset.rights.substring(r-1,r),f="R"+u;i[u]=["."+f,$.rightsAction[e]];$(this).addClass(f)}),i};$.vCheckRights=function(n){var t=$.vPrpRgts(n);$.vApplyRights(null,t)};$.vCheckPopupRights=function(n){var t=$.vPrpRgts(n.find(".modal.fade"));$.vApplyRights(null,t)};$.vApplyRights=function(n,t){$.vApplyXRights($.userArrRights,n,t)};$.vApplyAllRights=function(){$.vApplyRights(app.rights);$.vApplyCompRights(app.compRights)};$.vApplyCompRights=function(n,t){$.vApplyXRights($.compArrRights,n,t)};$.vApplyXRights=function(n,t,i){var e,u,r,f;if(i||(i=$.vPrpRgts()),t&&n.length<1)for(e=t.split("~"),r=1;r<e.length;r++)u=e[r].split("|"),n.push({type:u[0],id:u[1],status:u[2]=="1"?!0:!1});for(r=0;r<n.length;r++)f=n[r],f.type=="1"&&$.vApplyStaticRights(i,f.id,f.status)};$.vApplyStaticRights=function(n,t,i){var f=n[t],u,r;f&&(u=f[1],r=f[0],u&&r&&(u=="disabled"?$(r).prop("disabled",!i):u=="hide"&&(i=="1"?(u="show",$(r).removeClass("hidden"),$(r).removeClass("hidden2")):$(r).addClass("hidden2"),$(r)[u].call($(r)))))};$.vCheckAndAppendOptions=function(n,t,i,r,u,f){u||(u=$.vCheckRightsBeforeAdd(r,t));var e="";f&&$.each(f,function(n,t){e+=n+'="'+t+'" '});u&&n.append('<option value="'+t+'" '+e+">"+i+"<\/option>")};$.vCheckRightsBeforeAdd=function(n,t){for(var r,i=0;i<$.userArrRights.length;i++)if(r=$.userArrRights[i],n==r.type&&t==r.id)return r.status;return!0};$.vLoadRightConfig=function(n,t){if(cachedDemoRights[n]){t.val(cachedDemoRights[n]);return}vRqs({_a:"fGetRights",_c:{Code:n,Type:1},_f:"Info"},function(i,r,u){if(u==1){var f=r[0][0];cachedDemoRights[n]=[f];t.val(cachedDemoRights[n])}})};oRq={iAc:!1,cEl:null,cKey:null,cAType:1,cLType:null,cRqs:[]};var oTrs={waiting:0,normal:1,add:2,cancel:3,reactive:1,unknow:5},oPst={guide:5,driver:2,assistant:4},oTkt=[{r:"",v:"Chọn cấu hình"},{r:$.rights.mTicConf_hv.val,v:"Hết vé"},{r:$.rights.mTicConf_onl.val,v:"Bán vé online"},{r:"5|10103|1",v:"Bán vé online không có sơ đồ ghế"},{r:$.rights.mTicConf_ofl.val,v:"Bán vé offline"},{r:"5|10104|1",v:"Cấu hình vé được bán online"},{r:"5|10105|1",v:"Vé lễ tết"}];$.datepicker.regional.vi={closeText:"Đóng",prevText:"&#x3c;Trước",nextText:"Tiếp&#x3e;",currentText:"Hôm nay",monthNames:"Tháng Một;Tháng Hai;Tháng Ba;Tháng Tư;Tháng Năm;Tháng Sáu;Tháng Bảy;Tháng Tám;Tháng Chín;Tháng Mười;Tháng Mười Một;Tháng Mười Hai".split(";"),monthNamesShort:"Tháng 1;Tháng 2;Tháng 3;Tháng 4;Tháng 5;Tháng 6;Tháng 7;Tháng 8;Tháng 9;Tháng 10;Tháng 11;Tháng 12".split(";"),dayNames:"Chủ Nhật;Thứ Hai;Thứ Ba;Thứ Tư;Thứ Năm;Thứ Sáu;Thứ Bảy".split(";"),dayNamesShort:"CN T2 T3 T4 T5 T6 T7".split(" "),dayNamesMin:"CN T2 T3 T4 T5 T6 T7".split(" "),weekHeader:"Tu",dateFormat:"dd-mm-yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};$.datepicker.setDefaults($.datepicker.regional.vi),function(n){n.extend(!0,n.hik.jtable.prototype,{_ajax:function(t){var r=this,i=n.extend({},this.options.ajaxSettings,t),u;i.url&&(i.data==null||i.data==undefined?i.data={}:typeof i.data=="string"&&(i.data=r._convertQueryStringToObject(i.data)),u=i.url.indexOf("?"),u>-1&&n.extend(i.data,r._convertQueryStringToObject(i.url.substring(u+1))),i.data=JSON.stringify(i.data),i.contentType="application/json; charset=utf-8",i.success=function(n){n=r._normalizeJSONReturnData(n);t.success&&t.success(n)},i.error=function(){t.error&&t.error()},i.complete=function(){t.complete&&t.complete()},n.ajax(i))},_deselectRows:function(n){this.options.deselectedId=n.attr("data-record-key");n.removeClass("jtable-row-selected ui-state-highlight");this.options.selectingCheckboxes&&n.find(">td.jtable-selecting-column >input").prop("checked",!1);this._refreshSelectAllCheckboxState()},_addPagingInfoToUrl:function(n,t){if(!this.options.paging)return n;var i=(t-1)*this.options.pageSize,r=this.options.pageSize;return n==null?null:n+(n.indexOf("?")<0?"?":"&")+"jtStartIndex="+i+"&jtPageSize="+r},addLocalRecords:function(n){var t=this;t.options.actions.listAction=n;t._reloadTable()},removeAllRows:function(){var n=this;this._removeAllRows("reloading");n._selectedRecordIdsBeforeLoad||(n._selectedRecordIdsBeforeLoad=[]);n._onRecordsLoaded({Result:1,Records:null,TotalRecordCount:0,page:0})},getTotalRow:function(){return this._$tableRows.length},_createFieldAndColumnList:function(){var t=this,i=[];n.each(t.options.fields,function(n,r){t._fieldList.push(n);r.key==!0&&(t._keyField=n);r.list!=!1&&r.type!="hidden"&&i.push({idx:r.idx,name:n})});i.sort(function(n,t){var i=n.idx,r=t.idx;return i==r?0:i>r?1:-1});n.each(i,function(n,i){t._columnList.push(i.name)})},reloadOverwrite:function(t){this._lastPostData=t;this._currentPageNo=n(".jtable-goto-page select").val()==""||n(".jtable-goto-page select").val()==null?1:parseInt(n(".jtable-goto-page select").val());this._reloadTable()},addLocalRecord1:function(n){var t=this,u=t.options.actions.listAction,r,i;t.options.actions.listAction=n;r=function(n){if(t._hideBusy(),!n.Result){t._showError(n.Message);return}t._removeAllRows("reloading");t._addRecordsToTable(n.Records);t._onRecordsLoaded(n);t._currentPageNo=n.page};t._showBusy(t.options.messages.loadingMessage,t.options.loadingAnimationDelay);t._onLoadingRecords();i=t.options.actions.listAction(t._lastPostData,t._createJtParamsForLoading());t._isDeferredObject(i)?i.done(function(n){r(n)}).fail(function(){t._showError(t.options.messages.serverCommunicationError)}).always(function(){t._hideBusy()}):r(i);t.options.actions.listAction=u},applyPaging:function(n){this._onRecordsLoaded(n)},deselectRows:function(n){n&&this._deselectRows(n)},_createFirstAndPreviousPageButtons:function(){var t=n("<span><\/span>").addClass("jtable-page-number-first").html('<i class="glyphicon glyphicon-fast-backward"><\/i>').data("pageNumber",1).appendTo(this._$pagingListArea),i=n("<span><\/span>").addClass("jtable-page-number-previous").html('<i class="glyphicon glyphicon-backward"><\/i>').data("pageNumber",this._currentPageNo-1).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass(t,"ui-button ui-state-default","ui-state-hover");this._jqueryuiThemeAddClass(i,"ui-button ui-state-default","ui-state-hover");this._currentPageNo<=1&&(t.addClass("jtable-page-number-disabled"),i.addClass("jtable-page-number-disabled"),this._jqueryuiThemeAddClass(t,"ui-state-disabled"),this._jqueryuiThemeAddClass(i,"ui-state-disabled"))},_createLastAndNextPageButtons:function(t){var i=n("<span><\/span>").addClass("jtable-page-number-next").html('<i class="glyphicon glyphicon-forward"><\/i>').data("pageNumber",this._currentPageNo+1).appendTo(this._$pagingListArea),r=n("<span><\/span>").addClass("jtable-page-number-last").html('<i class="glyphicon glyphicon-fast-forward"><\/i>').data("pageNumber",t).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass(i,"ui-button ui-state-default","ui-state-hover");this._jqueryuiThemeAddClass(r,"ui-button ui-state-default","ui-state-hover");this._currentPageNo>=t&&(i.addClass("jtable-page-number-disabled"),r.addClass("jtable-page-number-disabled"),this._jqueryuiThemeAddClass(i,"ui-state-disabled"),this._jqueryuiThemeAddClass(r,"ui-state-disabled"))},_reloadTable:function(t){var i=this,f=function(n){if(i._hideBusy(),!n.Result){i._showError(n.Message);return}i._removeAllRows("reloading");i._addRecordsToTable(n.Records);i._onRecordsLoaded(n);t&&t(n)},r,u,e;i._showBusy(i.options.messages.loadingMessage,i.options.loadingAnimationDelay);i._onLoadingRecords();n.isFunction(i.options.actions.listAction)?(r={},u=i.options.actions.listAction(i._lastPostData,i._createJtParamsForLoading(),r),i._isDeferredObject(u)?u.done(function(n){r.Data&&(n=r.Data);f(n)}).fail(function(){i._showError(i.options.messages.serverCommunicationError)}).always(function(){i._hideBusy()}):f(u)):(e=i._createRecordLoadUrl(),i._ajax({url:e,data:i._lastPostData,success:function(n){f(n)},error:function(){i._hideBusy();i._showError(i.options.messages.serverCommunicationError)}}))},insertRecords:function(t,i,r,u){var f=this,e="";n.each(i,function(n,i){i.Id||(i.Id="-"+t);var u=f._createRowFromRecord(i);e+='<tr class ="jtable-data-row '+r+'" data-record-key = '+i.Id+">"+u.html()+"<\/tr>"});n("tr[data-record-key="+t+"]").after(e);u&&u.call(f)},showRecords:function(t,i,r){n.each(i,function(t,i){n("tr[data-record-key="+i.Id+"]").show()});r&&r.call(me)},delRecords:function(t,i,r){n.each(i,function(t,i){n("tr[data-record-key="+i.Id+"]").remove()});r&&r.call(me)},getOptions:function(){return this.options},getDeselectedId:function(){return this.options.deselectedId},getPageInfo:function(){return this._createJtParamsForLoading()},_getDisplayTextForRecordField:function(n,t){var i=this.options.fields[t],r=n[t],u;return i.display?i.display({record:n,name:t}):i.type=="date"?this._getDisplayTextForDateRecordField(i,r):i.type=="checkbox"?this._getCheckBoxTextForFieldByValue(t,r):i.options?(u=this._getOptionsForField(t,{record:n,value:r,source:"list",dependedValues:this._createDependedValuesUsingRecord(n,i.dependsOn)}),this._findOptionByValue(u,r).DisplayText):r}})}(jQuery);vv={_table:{url:"",fields:{},multiselect:!1,paging:!0,pageSize:10,sorting:!0,selecting:!0,selectingCheckboxes:!0},_toolTipCls:["form-group","form-group mb8"],_isCbb:function(n){var t=this;return(n.cbb||n.options)&&!t.isChosen(n)},_isRemoteData:function(n){return n.options.length==0&&n.listConfig},_gSelect:function(n,t){var r=[],i;t.each(function(){var n=$(this).data("record");r.push(n)});i=jQuery.Event("gSelect");i.rs=r;n.view.trigger(i)},_gDeselect:function(n,t){var r=this,i=jQuery.Event("gUnSelect");i.rs=t;n.view.trigger(i);n.autoClear&&r.clearFormAndGrid(n.view)},_getX:function(n){if(n.x&&typeof n.x=="string"){var t=$["x"+$.trim(n.x)];return typeof t=="function"?t.call(this,n):n}return n},_getWinBody:function(n,t){var u=this,f="",r="",h="",e,i,l;t.sort(function(n,t){var i=n.fIdx?n.fIdx:100,r=t.fIdx?t.fIdx:100;return i==r?0:i>r?1:-1});var a=t.length,o=0,c="",s=!0;for(e=0;e<t.length;e++)i=t[e],i=u._getX(i),parseInt(app.cid)==95&&(i.name=="Assistant"&&(i.form=!1,i.grid=!1),i.name=="Guide"&&(i.form=!0,i.grid=!0,i.fIdx=8,i.gIdx=6)),_dict._hasDriverTrip||i.name=="Description"&&(i.form=!1,i.grid=!1),i.flex||(i.flex=1),i.form&&(o+=i.flex),i.data&&gDx(n).push(i),i.grid&&n.table&&!n.table.hidden&&u._applyGridConfigs(n,i),u._applyXConfigs(i,n),i.items&&i.xtype?(l=u._getWinBody(n,i.items),i.html=l,f+=$.html(i.xtype,i)):i.xtype&&i.form&&(r+=$.html(i.xtype,i),h=r,o==n.cols||e==a-1?(i.notInRow||(r=u._getFormRow(r,n.xRowCls)),f+=r,r="",o=0,s=!1):(s=!0,c=r));return s&&(f+=u._getFormRow(c,n.xRowCls)),f||(f=h),f},_getFormRow:function(n,t){return t||(t=""),'<div class="row '+t+'">'+n+"<\/div>"},_applyGridConfigs:function(n,t){if(t.grid){t.gIdx==undefined&&(t.gIdx=100);var i=t.gDis;typeof t.gDis=="string"&&(i=n.p[t.gDis]);n.table.fields[t.name]={name:t.name,title:t.glbl?t.glbl:t.label,key:t.dType==1||t.key,list:!t.gHide,cf:t,type:t.gType,displayFormat:t.displayFormat,display:i,idx:t.gIdx,width:t.gWidth,listClass:t.gCls,sorting:!0}}},_applyXConfigs:function(n,t){n.form&&(t.id||(t.id=""),n.ref&&t.id&&n.ref.indexOf(t.id)<0&&(n.ref="#"+t.id+" "+n.ref),n.zRef&&t.id&&n.zRef.indexOf(t.id)<0&&(n.zRef="#"+t.id+" "+n.zRef),n.flex||(n.flex=1),n.colCls="col-md-"+12/t.cols*n.flex,t.useSmCls&&(n.smCls="col-sm-"+12/t.cols*n.flex),n.required&&n.requiredCls&&(n.cls=n.cls+" "+n.requiredCls))},_applyXSearch:function(n,t){t.options=[];$.each(gDx(n),function(n,i){i.xSearch&&(i.Id=n,i.Name=i.label,i.xSearchAlways&&(i.Disabled=i.xSearchAlways),t.options.push(i))})},_getWinBtn:function(n,t){for(var i,e,u=this,f="",r=0;r<t.length;r++)i=t[r],e="col-md-"+i.colspan,i.colCls=e,i.xSearch&&u._applyXSearch(n,i),i.sbf?$.sbf=i:i.chosen&&u.pushChosen(n,i),f+=$.html(i.xtype,i);return f},_getWinHeader:function(n){return $.html("winHeaderTpl01",n)},_applyChose:function(n,t){var i=t.zRef;t.chosen.search_contains=!0;$(t.ref).chosen(t.chosen).on("change",function(r,u){t.e=r;t.a=u;n.vm.onChosenChange(t);$.isEmptyObject(t.vals)?t.zRef&&t.searchIcon&&vChIco(t,i):t.zRef&&t.searchIcon&&vUChIco(t,i)});t.zRef&&t.searchIcon&&vChIco(t,i)},initView:function(n){var t=n.c[2];n.view=typeof t=="string"&&t?$(t):$(".dialog-config");n.view.unbind()},initArrs:function(n){sDx(n)},initObjs:function(n){n.chosen={};n.datepicker={}},initGrid:function(n){var t=this;n.grid&&!n.gHide&&(n.table=vCloneObj(t._table),n.table.fields=n.gFields?n.gFields:{},n.pageSize&&(n.table.pageSize=n.pageSize),n.gHideCb&&(n.table.selectingCheckboxes=!1),n.view.trigger("gSelect",null),n.table.selectionChanged=function(){var i=$("#"+n.gId).jtable("selectedRows");i.length>0?t._gSelect(n,i):t._gDeselect(n,i)})},initForm:function(n){var i=this,r=n.winCls,u,o,t,f,e;r||(r="");u="";n.xWidth&&(u="-"+n.xWidth);o=i._getWinBody(n,n.items);t=n.childId;t||(t="");n.buttons=_.where(n.buttons,{form:!0});f={id:n.id,winCls:r,xWidth:u,header:i._getWinHeader({title:n.title}),buttons:i._getWinBtn(n,n.buttons),body:$.html("winMsgTpl01",{})+o,childId:t,gRights:n.gRights,gSubtitle:n.gSubTitle,gTitle:n.gTitle,gId:n.gId};e=n.c[2];typeof e=="string"&&e?n.view.html($.html(n.tpl?n.tpl:"mainContentTpl",f,!0)):n.view.html($.html(n.tpl?n.tpl:"winTpl",f,!0))},addViewModel:function(n){n.vm=new Vm(n);n.vm.load()},addGridClass:function(){$(".jtable-goto-page select").addClass("form-control");$(".jtable-page-size-change select").addClass("form-control");$("table.jtable").addClass("table").addClass("table-bordered").addClass("mb0").addClass("table-condensed");$(".jtable-page-list").find(".jtable-page-number-first").addClass("glyphicon").addClass("glyphicon-fast-backward");$(".jtable-goto-page select").addClass("form-control");$(".jtable-page-size-change select").addClass("form-control")},addFormToolTip:function(n){var t=this,i="."+n.winCls;$.each(t._toolTipCls,function(n,t){$(i+" ."+t).tooltip()})},viewModule:function(n){var i=n.c[2],t,r;if(typeof i!="string"||!i){t=n.view.find(".modal.fade");t.modal("show");n.view.on("hidden.bs.modal",function(){n.vm.close()});n.vm.onViewReady();r=$.fn.modal.Constructor.prototype.enforceFocus;$.fn.modal.Constructor.prototype.enforceFocus=function(){};t.on("hidden",function(){$.fn.modal.Constructor.prototype.enforceFocus=r});t.modal({backdrop:!1})}},applyDatePicker:function(){$("span.glyphicon-calendar").parent().on("click",function(){$(this).prev().datepicker("show")})},applyChosenSBF:function(n){var i=this,t=$.sbf;if(t){t.chosen.d=[];$.each(gDx(n),function(n,r){r.xSearchDefault&&(i.chose(t.ref,r.Id),t.chosen.d.push(r.Id))});t.chosen.search_contains=!0;$(t.ref).chosen(t.chosen).on("change",function(i,r){t.e=i;t.a=r;n.vm.onChangeSBF()});$.each(t.chosen.d,function(i,r){t.e={};t.a={selected:r+""};n.vm.onChangeSBF()})}},applyChosen:function(n){var t=this;$.each(gDx(n),function(i,r){if(t.isChosen(r)&&!r.sbf&&(t._applyChose(n,r),t._isRemoteData(r)))n.vm.onGetData(r)})},viewGrid:function(n){$("#"+n.gId).jtable(n.table);$("#"+n.gId).jtable("option","pageSize",25);$("#"+n.gId).jtable("option","ajaxSettings",null);n.gNoLoad||$("#"+n.gId).mask("Loading..........")},rights:function(n){$.vCheckPopupRights(n.view)},bind:function(n){n.vm.bind()},chose:function(n,t,i){i?$(n+" option").prop("selected",!1).filter('[value="'+t+'"]').prop("selected",!0):$(n+" option").filter('[value="'+t+'"]').prop("selected",!0)},isChosen:function(n){return n.chosen&&n.chosen.on&&!n.chosen.off},pushChosen:function(n,t){var i=this;i.isChosen(t)&&(n.chosen[t.name]=t)},enableItem:function(n,t,i){i?n.find(t).removeClass("btn-disabled").removeAttr("disabled"):n.find(t).addClass("btn-disabled").attr("disabled","disabled")},getBodyHtml:function(n){var t=this;return t._getWinBody(n,n.items)},clearFormAndGrid:function(n){n.find("div.panel-collapse").each(function(){$(this).removeClass("in")});n.find("input").each(function(){$(this).hasClass("noCls")||$(this).hasClass("Rs")||$(this).val("");$(this).hasClass("Rs")&&$(this).prop("checked",!1)});n.find("select").each(function(){$(this).hasClass("noCls")||$(this).val($(this).find("option").first().val())});n.find("textarea").each(function(){$(this).hasClass("noCls")||$(this).val("")});n.find("button.save").html('<i class="glyphicon glyphicon-plus"><\/i> Thêm');$("tr.jtable-data-row.jtable-row-selected").find('input[type="checkbox"]').prop("checked",!1);$(".jtable-row-selected").removeClass("jtable-row-selected")},unchose:function(n,t,i){i?$(n+" option").prop("selected",!1).filter('[value="'+t+'"]').prop("selected",!1):$(n+" option").filter('[value="'+t+'"]').prop("selected",!1)},clearChosen:function(n){$(n+" option").prop("selected",!1)},showMessage:function(n){$(n.element).addClass(n.type);$(n.element).fadeIn("fast");$(n.element).find("span.message-content").html(n.content);$(n.element).delay(1e3).fadeOut("fast",function(){$(n.element).removeClass(n.type)})},start:function(n){var t=this;n.p.start?n.p.start(n,function(){t.run(n)}):t.run(n)},run:function(n){try{var t=this;t.initView(n);t.initArrs(n);t.initObjs(n);t.initGrid(n);t.initForm(n);t.addViewModel(n);t.addGridClass(n);t.addFormToolTip(n);t.viewModule(n);t.applyDatePicker(n);t.applyChosenSBF(n);t.applyChosen(n);t.viewGrid(n);t.rights(n);t.bind(n)}catch(i){console.error(i)}}};$.xId=function(n){return{name:"Id",data:!0,dType:1,grid:!0,gQuery:!0,gHide:!0,gIdx:0,form:!1,fIdx:100,gDis:n.gDis}};$.xNo=function(n){return{name:"No",data:!0,gWidth:"80px",label:"# No",grid:!0,gQuery:!1,gHide:!1,gIdx:0,gCls:"grid-cell-center",gColType:"No",form:!1,fIdx:100,gDis:n.gDis}};$.xPersons=function(n){return{xtype:"xchosen",noSave:!0,data:!0,xSearch:!0,name:n.name,rootField:"TeamInfo",fIdx:n.fIdx,mType:n.type,gHide:!1,grid:n.grid,gIdx:n.gIdx,ref:"select."+n.name,chosen:{on:!0,width:"100%"},multi:!0,label:n.label,noAjax:n.noAjax,form:n.form,partInfo:!0,disabled:n.disabled,cls:n.name,rights:n.rights,options:[],gDis:n.gDis,rvc:n.rvc,svb:n.svb,svc:n.svc,listConfig:{ajax:{_a:"fGetPerson",_c:{CompId:app.cid,IsPrgStatus:1,Type:"$x= "+n.type},_f:"Id, FullName, Type, PhoneInfo"},valField:"Id",displayField:"FullName"}}};$.xVehicle=function(n){return{xtype:"xchosensingle",noSave:!0,data:!0,xSearch:!0,name:n.name,rootField:"VehicleInfo",allowEmpty:n.allowEmpty,fIdx:n.fIdx,mType:n.type,gHide:!1,grid:n.grid,gIdx:n.gIdx,ref:"select."+n.name,chosen:{on:!0,width:"100%"},multi:!1,label:n.label,form:n.form,partInfo:!0,disabled:n.disabled,cls:n.name,rights:n.rights,options:[],gDis:n.gDis,rvc:n.rvc,svb:n.svb,svc:n.svc,listConfig:{ajax:{_a:"fGetVehicle",_c:{CompId:app.cid,IsPrgStatus:1,Type:1},_f:"Id, Type, LicensePlate, VehicleTypeName"},valField:"Id",displayField:"LicensePlate"}}};Pager.prototype.updateInfo=function(n,t){var i=this;return i.totalRecords=n,i.totalPage=Math.ceil(n/i.itemsPerPage),i.currentPage=t,i.startButton=1-i.numberOfPageToBeShown/2>0?1-i.numberOfPageToBeShown/2:1,i.endButton=i.startButton+i.numberOfPageToBeShown<=i.totalRecords?i.startButton+i.numberOfPageToBeShown:i.totalRecords,this.onPageChanged!=null&&this.onPageChanged(),this};Pager.prototype.render=function(){var n=this,r=function(){var i,u,f,t,r;for($(n.container).html(pageTemplate),i=$(n.container+" ul.pages"),i.append(vtpl(pageButton,{type:"first",disabled:n.currentPage>1?"":"disabled",value:1,icon:"glyphicon-fast-backward"})),i.append(vtpl(pageButton,{type:"previous",disabled:n.currentPage>1?"":"disabled",value:n.currentPage-1,icon:"glyphicon-backward"})),n.startButton=n.currentPage-Math.floor(n.numberOfPageToBeShown/2)>0?n.currentPage-Math.floor(n.numberOfPageToBeShown/2):1,n.endButton=n.startButton+n.numberOfPageToBeShown-1<=n.totalPage?n.startButton+n.numberOfPageToBeShown-1:n.totalPage,u=!1,f=!1,$(n.container+" .allPages").html(""),t=1;t<=n.totalPage;t++)$(n.container+" .allPages").append(vtpl(selectPagesOption,{value:t})),r=0,t>=n.startButton&&t<=n.endButton?i.append(vtpl(pageButtonNumber,{value:t,active:t==n.currentPage?"active":""})):u==!1&&t<n.startButton?(r=n.startButton-Math.floor(n.numberOfPageToBeShown/2),i.append(vtpl(pageButtonNumber,{value:"...",pageToShow:r>0?r:1})),u=!0):f==!1&&t>n.endButton&&(r=n.endButton+Math.floor(n.numberOfPageToBeShown/2),i.append(vtpl(pageButtonNumber,{value:"...",pageToShow:r<n.totalPage?r:n.totalPage})),f=!0);i.append(vtpl(pageButton,{type:"next",disabled:n.currentPage<n.totalPage?"":"disabled",value:n.currentPage+1,icon:"glyphicon-forward"}));i.append(vtpl(pageButton,{type:"last",disabled:n.currentPage<n.totalPage?"":"disabled",value:n.totalPage,icon:"glyphicon-fast-forward"}))},t,i;return r(),vev(n.container+" ul.pages li a","click",function(){var t=$(this).attr("data-index");$(this).hasClass("disabled")||$(this).attr("data-index")=="..."||$(this).attr("data-index")!=null&&(n.currentPage=$(this).attr("data-index"),n.render(),n.onPageChanged!=null&&n.onPageChanged())}),$(n.container+" div.pager-info select.allPages").val(n.currentPage),t=(n.currentPage-1)*n.itemsPerPage,i={from:t+1,to:t+n.itemsPerPage>n.totalRecords?n.totalRecords:t+n.itemsPerPage,total:n.totalRecords},$(n.container+" div.pager-info span.summary").html(vtpl(summary,i)),vev(n.container+" div.pager-info select.allPages","change",function(){n.currentPage=$(this).val();n.render();n.onPageChanged!=null&&n.onPageChanged()}),$(n.container+" div.pager-info select.itemsPerPage").val(n.itemsPerPage),vev(n.container+" div.pager-info select.itemsPerPage","change",function(){n.currentPage=1;n.itemsPerPage=$(this).val();n.totalPage=Math.ceil(n.totalRecords/n.itemsPerPage);n.render();n.onPageChanged!=null&&n.onPageChanged()}),this};Pager.prototype.setVisible=function(n){n?$(this.container).show():$(this.container).hide()};Pager.prototype.getStartItem=function(){return(this.currentPage-1)*this.itemsPerPage};Pager.prototype.getEndItem=function(){return Math.min(this.currentPage*this.itemsPerPage,this.totalRecords)-1};var pageButtonNumber='<li style="float:left; " class="{active} pageButton"><a href="javascript:;" data-pageToShow="{pageToShow}"  data-index="{value}">{value}<\/a><\/li>',summary="{from}-{to} trên tổng số {total} dòng",pageButton='<li class="{disabled} {type}"><a href="javascript:;" data-index="{value}"><i class="glyphicon {icon}"><\/i><\/a><\/li>',selectPagesOption='<option value="{value}">{value}<\/option>',pageTemplate='<ul class="pages pagination pagination-sm mt0 fl" style="display: block;  padding: 5px;"><\/ul><div class="pager-info"><span style="float:left;margin-top:10px">Tới trang: <\/span><select class="allPages form-control input-sm" style="max-width:80px;float:left;"><\/select><span style="float:left;margin-top:10px">Số bản ghi:<\/span><select class="itemsPerPage form-control  input-sm" style="max-width:80px;float:left;"><option value="10">10<\/option><option value="20">20<\/option><option value="30">30<\/option><option value="40">40<\/option><option value="50">50<\/option><\/select><span style="float:left;margin-top:10px" class="summary"><\/span><\/div>';
//# sourceMappingURL=z.min.js.map
