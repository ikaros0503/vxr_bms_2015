define({_initOptionRoles:function(n){var i=this,r=i.view,u=n.gtArr({Type:2},!1),t=r.find("select.role");t.empty();$.each(u,function(n,i){$.vCheckAndAppendOptions(t,i.Id,i.Name,"R")})},_loadPerson:function(){var n=this,t,i;n._listPersons=[];t={_a:"fGetPerson",_c:{CompId:app.cid,IsPrgStatus:1},_f:"Id, Type, FullName, CompId, AgentId"};i=t._f.split(",");vRql(t,{a:function(){},m:function(t,r){var u={};$.each(i,function(n,t){t=t.trim();u[t]=r[n]});n._listPersons.push(u)},z:function(){}},n)},getCPersonId:function(n,t){var r=this.view,i=r.find("select.agent-id").val();return i&&(t.AgentId=i),t},onBeginSelectionChange:function(n,t){var r=this,i=r.view;vv.enableItem(n,"button.delete",t!=null);t&&(i.find("select.agent-id").trigger("change"),i.find("select.person-id").find("option[value="+t.PersonId+"]").prop("selected",!0))},onVMLoaded:function(){var t=this,n=!1;$(document).ajaxStop(function(){n||(t.view.find("select.agent-id").trigger("change"),n=!0)})},afterReload:function(n){var t=this;t._initOptionRoles(n);t.view.find("button.dupInfo").unbind().on("click",function(n){n.preventDefault();t._copyInfo(!0)});t._loadPerson()},onRoleChange:function(){this._copyInfo(!1)},_copyInfo:function(n){var s=this,h=s.view,c=parseInt(h.find("select.role").val()),t=[],r,u,i,f,e,o;if(!isNaN(c)&&(r=s.remoteModels.gtArr({Id:c},!1),r.length>0))for(u=r[0].Info.split("~"),i=1;i<u.length;i++)t.push(u[i].trim());f=h.find("input.account-info");n||(e=f.val().split(","),o=[],e.length>1&&$.each(e,function(n,t){var i=t.trim().split("|");i.length==3&&(isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||o.push(i.join("|")))}),t=_.union(o,t));f.val(t.join(", "))},onAgentChange:function(){var t=this,i=t.view,u=i.find(".agent-id").val(),n=i.find("select.person-id"),r=t._listPersons.gtArr({AgentId:parseInt(u)},!1);n.empty();r.length>0?($.each(r,function(t,i){$.vCheckAndAppendOptions(n,i.Id,i.FullName,"R")}),n.find("option:first-child").prop("selected","selected")):n.empty()},gDisRole:function(n){var r=this,i=n.record.Role,t=$(".dialog-config").find("select.role").find('option[value="'+i+'"]');return!t||t.length<1?"":t.text()},gDisAgentId:function(n){return n.record.AgentName},gDisPersonId:function(n){return n.record.PersonFullName},gDisInfo:function(n){var t=n.record.Info;return t.length>70?t.substring(0,70)+"....":t},svcPC:function(n,t,i){return i?app.cid+"-"+i.AgentId+"-"+i.PersonId:t},rvcInfo:function(n,t){if(vIsEstStr(t)){var i=t.substring(t.indexOf("~")+1).split("~");if(i.length>1)return i.join(", ")}return"Không có quyền"},svcInfo:function(n,t){var r=[1],i;return vIsEstStr(t)&&(i=t.split(","),i.length>1&&$.each(i,function(n,t){var i=t.trim().split("|");i.length==3&&(isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||r.push(i.join("|")))})),r.join("~")}});
//# sourceMappingURL=p.min.js.map
