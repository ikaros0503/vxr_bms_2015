var I=function(n,t,i,r,u,f){this._coach=parseInt(n);this._row=parseInt(t);this._col=parseInt(i);this._status=parseInt(r);this._class=u;this._label=f},S=function(n,t,i,r,u,f,e){I.call(this,n,t,i,r,u,f);this._type=parseInt(e);this._tickets=[];this._tickets_idxMaxStageCode=0;this._currentTicketIndex=-1;this._seatStatus=0};S.prototype._renderSeat=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var p=this,v=p._getCurrentTicket(i),kt=p._coach+"|"+p._row+"|"+p._col,vt,gt,ut,w,ni,ft,b,et,ot,st,d,k,it,pt,wt,g,ii,bt;v._status!=3&&(typeof _dict._blockSeatByVehicle!="undefined"&&$.each(_dict._blockSeatByVehicle,function(n,t){kt==t&&(p._status=2)}),typeof _dict._unblockSeatByVehicle!="undefined"&&c!=""&&typeof _dict._unblockSeatByVehicle[c]!="undefined"&&_dict._unblockSeatByVehicle[c].indexOf(kt)!=-1&&(p._status=1));var nt=$(),tt=null,ht="",rt=null,ct="",dt="",lt=0,at=0;if(typeof _dict._hasDefaultStagePerTrip!="undefined"&&_dict._hasDefaultStagePerTrip&&typeof _dict._defaultStagePerTrip[a]!="undefined"&&(vt=_dict._defaultStagePerTrip[a].split(","),lt=parseInt(vt[0]),at=parseInt(vt[1])),vIsEstStr(v.fromArea)?(gt=v.fromArea.indexOf("~"),ut=v.fromArea.substr(gt+1,v.fromArea.length).split("|"),tt={Id:ut[0],Type:ut[1],Code:ut[2],Name:ut[3]}):(w=null,typeof u.idx[lt]!="undefined"?(w=u.data[u.idx[lt]],tt={Id:w.Id,Type:w.Type,Code:w.Code,Name:w.Name}):(w=u.data[0],tt={Id:w.Id,Type:w.Type,Code:w.Code,Name:w.Name})),vIsEstStr(v.toArea)?(ni=v.toArea.indexOf("~"),ft=v.toArea.substr(ni+1,v.toArea.length).split("|"),rt={Id:ft[0],Type:ft[1],Code:ft[2],Name:ft[3]}):(b=null,typeof u.idx[at]!="undefined"?(b=u.data[u.idx[at]],rt={Id:b.Id,Type:b.Type,Code:b.Code,Name:b.Name}):(b=u.data[u.data.length-1],rt={Id:b.Id,Type:b.Type,Code:b.Code,Name:b.Name})),tt&&tt.Id!=u.data[0].Id&&(ht=tt.Code),rt&&(ct=rt.Code),dt=vIsEstStr(ht)?ht+" - "+ct:ct,p._isAvailable()){et=v._fare;vIsEstStr(v._surCharge)&&(et+=parseInt(v._surCharge));vIsEstStr(v._discount)&&(et-=parseInt(v._discount));var y={seat:{_coach:p._coach,_row:p._row,_col:p._col,_class:"available",_label:p._label,_pInfo:"",_numStagetickets:"",_stageticketsTooltips:"",_note:v._note,_cname:vGln(v._cname),_cphone:"",_nTicketPerTrip:n>1?" "+n+"G":"",_pmInfo:"",_suser:"",_cuser:"",_fare:vIsEstStr(et)?et.toMn()+"đ":"",_code:"",_notallow:""}},yt="",ri=!0,ti=p._renderStageTicketsInfo_Tooltips(p._tickets,u);$.isEmptyObject(v)||(y.seat._stageticketsTooltips=ti,y.seat._numStagetickets=p._tickets.length,y.seat._stageName=dt,ot=v._getPickupInfo(),yt=ot.type,y.seat._class=_dict._cc[v._status],y.seat._pInfo=$.isEmptyObject(ot)?"":ot.text,y.seat._cphone=v._getDefaultPhoneNumber(),y.seat._code=v._getTicketCode(),ri=!1,vIsEstStr(v._suser)&&(y.seat._suser="B:&nbsp;"+v._suser),p._updatePaymentInfo_AgentInfo_ToSeat(y,v),y.seat._pmInfo.indexOf("VXR")>0&&(y.seat._class+=" vxr"),st=!0,d=[],_dict._isFBooking.length>0&&$.each(_dict._isFBooking,function(n,t){var u,i,r;if(typeof t!="undefined"&&t!=null)for(u=t.split("|"),typeof d[n]=="undefined"&&(d[n]=!1),i=0;i<u.length;i++){r=v[u[i]];switch(typeof r){case"string":d[n]=d[n]||vIsEstStr(r);break;case"object":d[n]=d[n]||!$.isEmptyObject(r)}}}),$.each(d,function(n,t){st=st&&t}),st&&(y.seat._class+=" fbooking"),v._isCancelled()&&(y.seat._cuser="&nbsp;/&nbsp;C:&nbsp;"+v._getLastUpdateUser(),o==1&&v._canceledDate>s&&(y.seat._class="booking"),(v._cuser!=null||vIsEstStr(v._cuser))&&(y.seat._class="paid",y.seat._pmInfo==" - VXR"&&(y.seat._class+=" vxr"))));p._tickets.length>=1&&(k=v.stageCode,t=!1,k||(k=0),(k&i)==0?(y.seat._numStagetickets=p._tickets.length,y.seat._stageticketsTooltips=ti,y.seat._class=y.seat._class.replace("booking","").replace("fbooking",""),t=!0):k==i||k==1?t=!0:k&i&&k!=i&&(p.disableClickEvent=!0,y.seat._class="",it=p._getFirstStageTicketInSeat(),y.seat._cphone=it._getDefaultPhoneNumber(),pt=v._getPickupInfo(),yt=ot.type,y.seat._pInfo=$.isEmptyObject(pt)?"":pt.text,y.seat._cphone=it._getDefaultPhoneNumber(),y.seat._cname=vGln(it._cname),y.seat._note=it._note,p._updatePaymentInfo_AgentInfo_ToSeat(y,it),vIsEstStr(v._suser)&&(y.seat._suser="B:&nbsp;"+v._suser),y.seat._numStagetickets=p._tickets.length,y.seat._label=e==k?_dict._fullStageTicketLable:_dict._stageTicketLable,v.isStageSeat=!0));p._tickets.length!=1||f||v.stageCode!=i&&i!=0||(y.seat._numStagetickets="");t&&(wt=$("<div />"),g=0,$.isEmptyObject(v)||(g=v._status),ii=_dict._st[g],(v._type!=2||v._type==2&&app.rights.indexOf($.rights.bEdtOnlTic.val)>=0)&&($.each(_dict._at,function(n,t){if(ii.indexOf(n)!=-1){var i=!0;o==2?i=!1:(t[1]=="B"&&app.rights.indexOf($.rights.bBook.val)==-1&&(i=!1),t[1]=="U"&&app.rights.indexOf($.rights.bUpdate.val)==-1&&(i=!1),t[1]=="M"&&!_dict._stageTicketshowMButton&&f&&(i=!1),app.rights.indexOf($.rights.bEnBtnAtDpt.val)==-1&&t[1]=="M"&&(g==2||g==5)&&o==1&&h&&(i=!1),t[1]=="M"&&app.rights.indexOf($.rights.bMove.val)==-1&&(i=!1),app.rights.indexOf($.rights.bQBook.val)==-1?t[1]=="P"&&(i=!1):t[1]=="P"&&g!=1&&(i=!1),app.rights.indexOf($.rights.bQPay.val)==-1?t[1]=="Q"&&(i=!1):t[1]=="Q"&&g!=1&&(i=!1));l||i&&wt.append($("<button />",{text:t[1],type:"button"}).addClass(t[4]).attr("data-type",t[5]))}}),y.seat._notallow=typeof l!="undefined"&&l?"notallow":""),y.seat.buttons=wt.html());nt=$.isEmptyObject(v)&&p._tickets.length<=0?$(vtpl(_dict._sTpl,y)):$.isEmptyObject(v)&&p._tickets.length>=1?$(vtpl(_dict._svcTpl,y)):v.stageCode>=e||v.stageCode==1?$(vtpl(_dict._sTpl,y)):$(vtpl(_dict._svcTpl,y));yt=="T"&&nt.find(".pick").addClass("transfer");y.seat._pInfo==""&&nt.find(".pick").css("background","none");v._seri!=null&&v._seri!=""&&nt.find(".seat-code").addClass("exported")}else bt={seat:{_label:p._label}},nt=v.stageCode>=e?$(vtpl(_dict._lksvcTpl,bt)):$(vtpl(_dict._lksTpl,bt));return nt};S.prototype._updatePaymentInfo_AgentInfo_ToSeat=function(n,t){var i=t._getPaymentInfo(),r=t._getAgentInfo();if($.isEmptyObject(i))$.isEmptyObject(r)||(n.seat._pmInfo=r._code,n.seat._pmFullInfo="CN/ĐL:&nbsp;"+r._name);else{switch(i.type){case 1:case 6:typeof i.info!="undefined"&&(n.seat._pmInfo=i.info._code,n.seat._pmFullInfo="CN/ĐL:&nbsp;"+i.info._name);break;case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:n.seat._pmInfo=i.sname;n.seat._pmFullInfo="CN/ĐL:&nbsp;"+i.name}vIsEstStr(t._cuser)&&!t._isCancelled()&&(n.seat._cuser="&nbsp;/&nbsp;P:&nbsp;"+t._cuser)}typeof n.seat._pmInfo!="undefined"&&n.seat._pmInfo.length>0&&(n.seat._pmInfo=" - "+n.seat._pmInfo)};S.prototype._getFirstStageTicketInSeat=function(){var n=this,t;return n._tickets_idxMaxStageCode==-1?{}:(t=n._tickets[n._tickets_idxMaxStageCode],t?t:{})};S.prototype._renderStageTicketsInfo_Tooltips=function(n,t){var i="",r;return t&&(r=t.data.length-1,$.each(n,function(n,u){var a="T"+u._id,o=u.stageCode.toString(2),e=r-o.length,f=o.indexOf("0");f=f==-1?r:e+f;u.stage_Idx1=e;u.stage_Idx2=f;var h=u._cphone?u._cphone:"",c=u._cname?u._cname:"",l="<p class='nhieu-chang-ng-dat'><small>"+c+" "+h+"<\/small><\/p>",s="";t.data[e]!=null&&(u.stage_point1=t.data[e],u.stage_point2=t.data[f],s="<a href='#' data-fromId='"+u.stage_point1.Id+"' data-toId='"+u.stage_point2.Id+"' class='stage-ticket-context'>"+u.stage_point1.Code+" - "+u.stage_point2.Code+"<\/a>");i=i+"<li>"+s+l+"<\/li>"})),i};S.prototype._renderPrintStageSeat=function(){var n=this,t={pseat:{_label:n._label,_pmInfo:"",_cname:"",_cphone:"",_note:"VÉ CHẶNG",_nTicketPerTrip:"",_hidden:"hidden",_seri:n._code}};return $(vtpl(_dict._pssTpl,t))};S.prototype._renderPrintSeat=function(n,t){var v=this,r=v._getCurrentTicket(),e=null,h="",c=null,l="",y="",p,o,w,s,i,u,f,b,a;if(vIsEstStr(r.fromArea)&&(p=r.fromArea.indexOf("~"),o=r.fromArea.substr(p+1,r.fromArea.length).split("|"),e={Id:o[0],Type:o[1],Code:o[2],Name:o[3]}),vIsEstStr(r.toArea)&&(w=r.toArea.indexOf("~"),s=r.toArea.substr(w+1,r.toArea.length).split("|"),c={Id:s[0],Type:s[1],Code:s[2],Name:s[3]}),e&&(t?e.Id!=t.data[0].Id&&(h=e.Code):h=e.Code),c&&(l=c.Code),y=vIsEstStr(h)?h+" - "+l:l,i={pseat:{_label:v._label,_pmInfo:"",_cname:vGln(r._cname),_cphone:"",_note:r._note,_nTicketPerTrip:n>1?"-"+n+"G":"",_cFullName:r._cname,_stageName:y}},$.isEmptyObject(r))i.pseat._hidden="hidden";else{if(r._status!=1&&(i.pseat._dathanhtoan="da-thanh-toan"),i.pseat._cphone=r._getDefaultPhoneNumber(),i.pseat._fare=r._fare.toMn()+"đ",i.pseat._cuser=r._cuser,i.pseat._suser=r._suser,typeof _dict._onlyPaidBackGround!="undefined"&&_dict._onlyPaidBackGround&&r._status==1&&(i.pseat._onlyPaidBackGround="no-background"),u=r._getPaymentInfo(),f=r._getAgentInfo(),$.isEmptyObject(u))$.isEmptyObject(f)||(typeof _dict._noShowAgentInfo!="undefined"&&_dict._noShowAgentInfo?(i.pseat._pmInfo="",i.pseat._pmFullInfo=""):(i.pseat._pmInfo=f._code,i.pseat._pmFullInfo=f._name));else{i.pseat._paid="paid";switch(u.type){case 1:typeof _dict._showUCharge!="undefined"&&_dict._showUCharge?r._cuser!=""?(b=r._cuser.split("."),i.pseat._pmInfo=b[0]):i.pseat._pmInfo="":$.isEmptyObject(u.info)?(i.pseat._pmInfo=f._code,i.pseat._pmFullInfo=f._name):(i.pseat._pmInfo=u.info._code,i.pseat._pmFullInfo=u.info._name);break;case 6:i.pseat._pmInfo=u.info._code;i.pseat._pmFullInfo=u.info._name;break;case 2:case 3:case 4:typeof _dict._noBackground!="undefined"&&_dict._noBackground&&(i.pseat._nobackground="no-background");i.pseat._pmInfo=u.sname;i.pseat._pmFullInfo=u.name;break;case 5:case 7:case 8:case 9:case 10:i.pseat._pmInfo=u.sname;i.pseat._pmFullInfo=u.name}}vIsEstStr(r._seri)&&(i.pseat._exported="exported");a=r._getPickupInfo();$.isEmptyObject(a)?i.pseat._hidden="hidden":i.pseat._pInfo=a.text}return $(vtpl(_dict._psTpl,i))};S.prototype._renderCustomData=function(n){return $(vtpl(_dict._psTpl_SeatGroup,n))};S.prototype._renderLSeat=function(n,t,i,r,u){var s=this,a=$(),f=null,e,h,o,c,l,p;if(s._isAvailable()){if(f=typeof r!="undefined"?r:s._getCurrentTicket(),e={seat:{_index:t,_coach:s._coach,_row:s._row,_col:s._col,_class:"available",_pInfo:"",_label:s._label,_cname:vGln(f._cname),_nTicketPerTrip:n>1?"("+n+"G)":"",_cphone:"",_idate:"",_total:0,_status:"",_pmInfo:"",_pmFullInfo:"",_suser:"",_cuser:"",_note:f._note,_stageName:u,_fromCode:"",_fromName:"",_toCode:"",_toName:""}},!$.isEmptyObject(f)){if(f.fromArea!=undefined&&f.fromArea!=null){var v=f.fromArea.split("|"),w=v[2],b=v[3];e.seat._fromCode=w;e.seat._fromName=b}if(f.toArea!=undefined&&f.toArea!=null){var y=f.toArea.split("|"),k=y[2],d=y[3];e.seat._toCode=k;e.seat._toName=d}if(h=f._getPickupInfo(),$.isEmptyObject(h)||(e.seat._pInfo=h.text),e.seat._cphone=f._getDefaultPhoneNumber(),e.seat._idate=f._issue.toFormatString("dd-mm-yyyy hh:ii"),e.seat._total=f._fare.toMn()+"đ",e.seat._status=f._getStatusText(),e.seat._suser=f._suser,f._isPaid()||f._isPass()){if(o=f._getPaymentInfo(),!$.isEmptyObject(o)){switch(o.type){case 1:case 6:typeof o.info!="undefined"&&(e.seat._pmInfo=o.info._code,e.seat._pmFullInfo="CN/ĐL:&nbsp;"+o.info._name);break;case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:e.seat._pmInfo=o.sname;e.seat._pmFullInfo=o.name}vIsEstStr(f._cuser)&&(e.seat._cuser=f._cuser)}}else f._isCancelled()&&(e.seat._cuser=f._getLastUpdateUser());e.seat._issue=f._issue.getTime()}i&&!app.oRights.StageEnable&&(c=$("<div />"),l=0,$.isEmptyObject(f)||(l=f._status),p=_dict._lst[l],$.each(_dict._at,function(n,t){p.indexOf(n)!=-1&&c.append($("<button />",{text:t[1],type:"button"}).addClass(t[4]).attr("data-type",t[5]))}),e.seat._buttons=c.html());a=$(vtpl(_dict._ilTpl,e))}return a};S.prototype._getSeatInfo=function(){var n=this;return n._label+"|"+n._coach+"|"+n._row+"|"+n._col};S.prototype._getSeatType=function(){return this._type};S.prototype._addTicket=function(n,t){var i=this,r=i._tickets.push(n)-1;i._tickets[r].stageCode&t&&(i._currentTicketIndex=r);isNaN(i._tickets[r].stageCode)||(i._seatStatus=i._seatStatus|i._tickets[r].stageCode,(r==0||i._tickets[r].stageCode>=i._tickets[i._tickets_idxMaxStageCode].stageCode)&&(i._tickets_idxMaxStageCode=r))};S.prototype._getCurrentTicket=function(n){var i=this,t;return i._currentTicketIndex==-1?{}:(t=i._tickets[i._currentTicketIndex],t&&t.stageCode&&n&&n>=1&&(n&t.stageCode)==0)?{}:t?t:{}};S.prototype._getTicketById=function(n){var i=this,t={};return $.each(i._tickets,function(i,r){$.isEmptyObject(t)&&r._id==n&&(t=r)}),t};S.prototype._changeStatus=function(n){this._status=n};S.prototype._isAvailable=function(){return this._status==1};S.prototype._isLock=function(){return this._status==2};S.prototype._hasTicket=function(){return this._tickets.length>0};S.prototype._clone=function(){var n=this;return $.extend({},n)};
//# sourceMappingURL=z.min.js.map
