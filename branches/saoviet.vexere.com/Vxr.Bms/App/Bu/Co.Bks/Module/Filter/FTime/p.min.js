define({start:function(){this._bindFTimeEvents();this._bindBodyEvent()},_bindFTimeEvents:function(){var n=this,t=$("#FilterForm select[name=TimeSlot]");if(t.length>0)$("#FilterForm select[name=TimeSlot]").unbind().on("change",function(){app.cTime=$(this).val();vbf("fTimeChange",{value:$(this).val()})});else setTimeout(function(){n._bindFTimeEvents()},50)},_bindBodyEvent:function(){var n=this;vev("body","fMapAvaiSeat",function(t){n._mapAvailableSeat(t)});vev("body","fReloadTimeSlot",function(t){n._reloadTimeSlot(t)});vev("body","fSetTime",function(n){$("#FilterForm select[name=TimeSlot]").val(n.d.value);app.cTime=n.d.value})},_mapAvailableSeat:function(n){var t=n.d.value,i=n.d.data,r=$("#FilterForm select[name=TimeSlot] option");$.each(r,function(n,r){var f=0,e,u;$.each(i,function(n,t){r.value==t[2]&&(f=t[3])});typeof t._data[t._cTripIndex].Ts[r.value]!="undefined"&&(e=t._data[t._cTripIndex].Ts[r.value][0].NS-f,u=r.value,t._data[t._cTripIndex].Ts[r.value][0].S==2&&(u+=" - Tăng cường"),$(r).text(u+" / Ghế trống "+e))})},_reloadTimeSlot:function(n){var t=n.d.value,e=$("#FilterForm select[name=TimeSlot]").empty(),c=new Date,u,o,i,r,l,s,h;if(c.setSeconds(0),u=new Date(t._cTripDate.getTime()),u.setSeconds(0),o={},t._data[t._cTripIndex])for(i=Object.keys(t._data[t._cTripIndex].Ts),l=i.length,i.sort(),r=0;r<l;r++)if(app.rights.indexOf($.rights.bUBlockBks.val)==-1)if(typeof _dict._hasBlockBKSByTime!="undefined"&&_dict._hasBlockBKSByTime&&typeof _dict._dayBlockBKS!="undefined"&&typeof _dict._hourBlockBKS!="undefined"&&typeof _dict._minuteBlockBKS!="undefined"){var v=_dict._dayBlockBKS,y=_dict._hourBlockBKS,p=_dict._minuteBlockBKS,f=new Date;if(f.setDate(f.getDate()-v),f.setHours(f.getHours()-y),f.setMinutes(f.getMinutes()-p),i[r]!=null){var a=i[r].split(":"),w=parseInt(a[0]),b=parseInt(a[1]);u.setHours(w);u.setMinutes(b);f<=u&&(o[i[r]]=t._data[t._cTripIndex].Ts[i[r]])}}else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];s=!1;$.each(o,function(n,i){var f,r,o;i[0].S!=3&&(f=n,i[0].S==2&&(f+=" - Tăng cường"),r=$("<option />",{text:f,value:n}),s||(o=n.split(":"),u.setHours(parseInt(o[0])),u.setMinutes(parseInt(o[1])),t._cTripTime!=null?n==t._cTripTime&&(r.attr("selected",!0),s=!0,app.cTime=t._cTripTime):u>c&&(r.attr("selected",!0),s=!0,app.cTime=n)),e.append(r))});s||(h=e.find("option:first-child"),h.attr("selected",!0),vbf("doChangeCTripTime",{value:h.val()}),app.cTime=h.val());e.val()!=t._cTripTime&&(vbf("doChangeCTripTime",{value:e.val()}),app.cTime=e.val())}});
//# sourceMappingURL=p.min.js.map
