define({contractInfo:[],cancelFee:[],trips:[],onBeginSelectionChange:function(n,t){vv.enableItem(n,"button.delete",t!=null);t!=null&&t.ContractInfo!=null&&(this.contractInfo=this.parseArray(t.ContractInfo));t!=null&&t.CancelFee!=null&&(this.cancelFee=this.parseArray(t.CancelFee));this.renderView(t!=null&&t.Type==3)},onVMLoaded:function(){var n=this;vev("select.type","change",function(){n.o.queryConditions.Type="($x="+$(this).val()+") order by IsPrgUpdatedDate desc";n.load()})},parseArray:function(n){var r=String(n).split("~"),u=[],t,i,f;if(r.length>1)for(t=1;t<r.length;t++)i=String(r[t]).split("|"),f={tripId:i[0],p:i[1],m:i[2]},u.push(f);return u},updateArray:function(n,t){if(typeof t.length!="undefined"){for(var i=0;i<t.length;i++)if(n.tripId==t[i].tripId)return t[i]=n,t;t.push(n)}else t.push(n);return t},buildStringFromArray:function(n){var i,t;if(typeof n.length!="undefined"){for(i="1",t=0;t<n.length;t++)i+="~"+n[t].tripId+"|"+n[t].p+"|"+n[t].m;return i.replace(/\./g,"")}return""},saveContractToArray:function(){var n={tripId:$("#selContractInfo").val(),p:$("#txtContractInfoPercentage").val(),m:$("#txtContractInfoMoney").val()};$("input[type='radio'][name='rdoContractInfo']:checked").val()=="percentage"?n.m="":n.p="";this.contractInfo=this.updateArray(n,contractInfo);$("input.contractInfo").val(this.buildStringFromArray(contractInfo))},saveCancelFeeToArray:function(){var n={tripId:String($("#selCancelFee").val()),p:$("#txtCancelFeePercentage").val(),m:$("#txtCancelFeeMoney").val()};$("input[type='radio'][name='rdoCancelFee']:checked").val()=="percentage"?n.m="":n.p="";this.cancelFee=this.updateArray(n,cancelFee);$("input.cancelFee").val(this.buildStringFromArray(cancelFee))},setViewContactInfo:function(n){n.p!=""?($("input:radio[name = 'rdoContractInfo'][value='percentage']").attr("checked",!0),$("#txtContractInfoPercentage").val(n.p),$("#txtContractInfoMoney").val(""),$("#txtContractInfoPercentage").prop("disabled",!1),$("#txtContractInfoMoney").prop("disabled",!0)):($("input:radio[name = 'rdoContractInfo'][value='money']").attr("checked",!0),$("#txtContractInfoPercentage").val(""),$("#txtContractInfoMoney").val(vToMn(n.m)),$("#txtContractInfoPercentage").prop("disabled",!0),$("#txtContractInfoMoney").prop("disabled",!1))},setViewCancelFee:function(n){n.p!=""?($("input:radio[name = 'rdoCancelFee'][value='percentage']").attr("checked",!0),$("#txtCancelFeePercentage").val(n.p),$("#txtCancelFeeMoney").val(""),$("#txtCancelFeePercentage").prop("disabled",!1),$("#txtCancelFeeMoney").prop("disabled",!0)):($("input:radio[name = 'rdoCancelFee'][value='money']").attr("checked",!0),$("#txtCancelFeePercentage").val(""),$("#txtCancelFeeMoney").val(vToMn(n.m)),$("#txtCancelFeePercentage").prop("disabled",!0),$("#txtCancelFeeMoney").prop("disabled",!1))},renderView:function(n){var t=this,i;if($("div.addition").remove(),n)if($(htmlContractInfo).insertBefore("div.modal-footer"),$("#txtContractInfoPercentage").blur(function(){t.isStringNullOrEmpty($(this).val())&&$(this).val("0");t.saveContractToArray()}),$("#txtContractInfoMoney").blur(function(){t.isStringNullOrEmpty($(this).val())&&$(this).val("0");t.saveContractToArray();$(this).val(vToMn($(this).val()))}),$("#txtCancelFeePercentage").blur(function(){t.isStringNullOrEmpty($(this).val())&&$(this).val("0");t.saveCancelFeeToArray()}),$("#txtCancelFeeMoney").blur(function(){t.isStringNullOrEmpty($(this).val())&&$(this).val("0");t.saveCancelFeeToArray();$(this).val(vToMn($(this).val()))}),$("#selContractInfo").on("focus",function(){t.saveContractToArray()}).change(function(){var i=!1,n;if(contractInfo!=null&&typeof contractInfo.length!="undefined")for(n=0;n<contractInfo.length;n++)$(this).val()==contractInfo[n].tripId&&(i=!0,t.setViewContactInfo(contractInfo[n]));i==!1&&($("#txtContractInfoPercentage").val(""),$("#txtContractInfoMoney").val(""))}),$("#selCancelFee").on("focus",function(){t.saveCancelFeeToArray()}).change(function(){var i=!1,n;if(cancelFee!=null&&typeof cancelFee.length!="undefined")for(n=0;n<cancelFee.length;n++)$(this).val()==cancelFee[n].tripId&&(i=!0,t.setViewCancelFee(cancelFee[n]));i==!1&&($("#txtCancelFeePercentage").val(""),$("#txtCancelFeeMoney").val(""))}),$('input:radio[name = "rdoContractInfo"]').change(function(){$(this).val()=="percentage"?($("#txtContractInfoPercentage").attr("disabled",!1),$("#txtContractInfoMoney").attr("disabled",!0),$("#txtContractInfoPercentage").focus()):($("#txtContractInfoPercentage").attr("disabled",!0),$("#txtContractInfoMoney").attr("disabled",!1),$("#txtContractInfoMoney").focus())}),$('input:radio[name = "rdoCancelFee"]').change(function(){$(this).val()=="percentage"?($("#txtCancelFeePercentage").attr("disabled",!1),$("#txtCancelFeeMoney").attr("disabled",!0),$("#txtCancelFeePercentage").focus()):($("#txtCancelFeePercentage").attr("disabled",!0),$("#txtCancelFeeMoney").attr("disabled",!1),$("#txtCancelFeeMoney").focus())}),trips.length>0){for(i=0;i<trips.length;i++)$("#selContractInfo").append("<option value="+trips[i][0]+">"+trips[i][1]+"<\/option>"),$("#selCancelFee").append("<option value="+trips[i][0]+">"+trips[i][1]+"<\/option>");contractInfo.length>0&&($("#selContractInfo").val(contractInfo[0].tripId),t.setViewContactInfo(contractInfo[0]));cancelFee.length>0&&($("#selCancelFee").val(cancelFee[0].tripId),t.setViewCancelFee(cancelFee[0]))}else vRqs({_a:"fGetTrip",_c:{CompId:app.cid,Type:1},_f:"Id, Name"},function(n,i){trips=i;for(var r=0;r<i.length;r++)$("#selContractInfo").append("<option value="+i[r][0]+">"+i[r][1]+"<\/option>"),$("#selCancelFee").append("<option value="+i[r][0]+">"+i[r][1]+"<\/option>");contractInfo.length>0&&($("#selContractInfo").val(contractInfo[0].tripId),t.setViewContactInfo(contractInfo[0]));cancelFee.length>0&&($("#selCancelFee").val(cancelFee[0].tripId),t.setViewCancelFee(cancelFee[0]))})},onActionComplete:function(){vdc.gCompany({BaseId:app.cid,IsPrgStatus:1,Type:"($x in (2,3))"},"Id, Type, Code, Name, AddressInfo, PhoneInfo",!0,null)},gDisType:function(n){var i=n.record.Type,t=_.where(this.cf.options,{Id:parseInt(i)});return!t||t.length<1?"":t[0].Name},rvcAvailableFund:function(n,t){return vToMn(t)},svcAvailableFund:function(n,t){return vToNum(t)},svcInfo:function(n,t){return t.replace(/;|:/g,",").trim().toUpperCase()},isStringNullOrEmpty:function(n){return typeof n!="undefined"&&n!=null&&typeof n.length!="undefined"&&n.length>0&&n!=""}});
//# sourceMappingURL=p.min.js.map
