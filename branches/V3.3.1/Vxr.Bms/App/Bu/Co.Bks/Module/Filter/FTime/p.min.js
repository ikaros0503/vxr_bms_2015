define({start:function(){try{this._bindFTimeEvents();this._bindBodyEvent()}catch(n){console.error(n)}},_bindFTimeEvents:function(){var n=this,t=$("#FilterForm select[name=TimeSlot]");if(t.length>0){$("#FilterForm select[name=TimeSlot]").unbind("change").on("change",function(){app.cTime=$(this).val();vbf("fTimeChange",{value:$(this).val()})});$("#FilterForm select[name=TimeSlot]").unbind("mouseenter").on("mouseenter",function(){var n=null;app.deltaTimeEnterFTime?(n=new Date-app.deltaTimeEnterFTime,app.deltaTimeEnterFTime=new Date):app.deltaTimeEnterFTime=new Date;(n>app.FTimeLimitedRequestTime||n==null)&&vbf("doGetMultiTotalSeats")})}else setTimeout(function(){n._bindFTimeEvents()},50)},_bindBodyEvent:function(){var n=this;vev("body","fMapAvaiSeat",function(t){n._mapAvailableSeat(t)});vbv("bUpdateAvaiSeats",function(t){t.d&&n._mapAvailableSeat(t,t.d.TotalBookedSeats,t.d.TotalExpiredSeats,t.d.ArrayTotalTimes)});vev("body","fReloadTimeSlot",function(t){n._reloadTimeSlot(t)});vev("body","fSetTime",function(n){$("#FilterForm select[name=TimeSlot]").val(n.d.value);app.cTime=n.d.value})},_ip:null,_getBAvailSeat:function(n,t,i){var c=this,f=n.Ts[t.value][0],s,h,r,u,e,o;if(i!=null&&$.each(i,function(n,i){var r=i[0];r==t.value&&(f.TotalBookedSeats=i[1])}),s=f.NS-(f.TotalBookedSeats?f.TotalBookedSeats:0),typeof _dict._blockSeatByVehicle!="undefined"&&(s-=_dict._blockSeatByVehicle.length,typeof _dict._unblockSeatByVehicle!="undefined"&&vIsEstStr(f.V)))try{h=f.V.split("|")[2];typeof _dict._unblockSeatByVehicle[h]!="undefined"&&(s+=_dict._unblockSeatByVehicle[h].length)}catch(l){}if(isNaN(s)&&(s=0),r="",_dict._hasDriverTrip)if(f.TripDriver!=null)if(u=f.TripDriver.split("~"),u.length>1){for(e=0;e<u.length;e++)if(o=u[e].split("|"),o[0]===t.value&&o[1]!=""){r+=o[1];break}}else u[0]!=""&&(r+=u[0]);else if(n.TripDriver!=null)if(u=n.TripDriver.split("~"),u.length>1){for(e=0;e<u.length;e++)if(o=u[e].split("|"),o[0]===t.value&&o[1]!=""){r+=o[1];break}}else u[0]!=""&&(r+=u[0]);r!=""?(f.S==2&&(r+=" - (TC)"),r+=" / Ghế trống "+s+" / "+t.value):(r+=t.value,f.S==2&&(r+=" - (TC)"),r+=" / Ghế trống "+s);$(t).text(r)},_mapAvailableSeat:function(n,t,i,r){var f=this,u=n.d.value,o=$("#FilterForm select[name=TimeSlot] option"),e=$("#FilterForm select[name=TimeSlot]").val();$.each(o,function(n,i){i&&(t==null?u._data[u._cTripIndex]&&typeof u._data[u._cTripIndex].Ts[i.value]!="undefined"&&(e==i.value?(f._ip=u._data[u._cTripIndex],vbf("doGetTotalSeats")):f._getBAvailSeat(u._data[u._cTripIndex],i,r)):e==i.value&&(f._ip.Ts[i.value][0].TotalBookedSeats=t,f._getBAvailSeat(f._ip,i)))})},_reloadTimeSlot:function(n){var t=n.d.value,e=$("#FilterForm select[name=TimeSlot]").empty(),c=new Date,u,o,i,r,l,s,h;if(c.setSeconds(0),u=new Date(t._cTripDate.getTime()),u.setSeconds(0),o={},t._data[t._cTripIndex])for(i=Object.keys(t._data[t._cTripIndex].Ts),l=i.length,i.sort(),r=0;r<l;r++)if(app.rights.indexOf($.rights.bUBlockBks.val)==-1)if(typeof _dict._hasBlockBKSByTime!="undefined"&&_dict._hasBlockBKSByTime&&typeof _dict._dayBlockBKS!="undefined"&&typeof _dict._hourBlockBKS!="undefined"&&typeof _dict._minuteBlockBKS!="undefined"){var v=_dict._dayBlockBKS,y=_dict._hourBlockBKS,p=_dict._minuteBlockBKS,f=new Date;if(f.setDate(f.getDate()-v),f.setHours(f.getHours()-y),f.setMinutes(f.getMinutes()-p),i[r]!=null){var a=i[r].split(":"),w=parseInt(a[0]),b=parseInt(a[1]);u.setHours(w);u.setMinutes(b);f<=u&&(o[i[r]]=t._data[t._cTripIndex].Ts[i[r]])}}else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];s=!1;$.each(o,function(n,i){var f,r,o;i[0].S!=3&&(f=n,i[0].S==2&&(f+=" - (TC)"),r=$("<option />",{text:f,value:n}),s||(o=n.split(":"),u.setHours(parseInt(o[0])),u.setMinutes(parseInt(o[1])),t._cTripTime!=null?n==t._cTripTime&&(r.attr("selected",!0),s=!0,app.cTime=t._cTripTime):u>c&&(r.attr("selected",!0),s=!0,app.cTime=n)),e.append(r))});s||(h=e.find("option:first-child"),h.attr("selected",!0),vbf("doChangeCTripTime",{value:h.val()}),app.cTime=h.val());e.val()!=t._cTripTime&&(vbf("doChangeCTripTime",{value:e.val()}),app.cTime=e.val())}});
//# sourceMappingURL=p.min.js.map
