define({start:function(){try{this._bindFTimeEvents();this._bindBodyEvent()}catch(n){console.error(n)}},_bindFTimeEvents:function(){var n=this,t=$("#FilterForm select[name=TimeSlot]");if(t.length>0)$("#FilterForm select[name=TimeSlot]").unbind().on("change",function(){app.cTime=$(this).val();vbf("fTimeChange",{value:$(this).val()})});else setTimeout(function(){n._bindFTimeEvents()},50)},_bindBodyEvent:function(){var n=this;vev("body","fMapAvaiSeat",function(t){n._mapAvailableSeat(t)});vev("body","fReloadTimeSlot",function(t){n._reloadTimeSlot(t)});vev("body","fSetTime",function(n){$("#FilterForm select[name=TimeSlot]").val(n.d.value);app.cTime=n.d.value})},_mapAvailableSeat:function(n){var t=n.d.value,i=n.d.data,r=$("#FilterForm select[name=TimeSlot] option");$.each(r,function(n,r){var s=t._data[t._cTripIndex].Ts[r.value][0].S,h,c,f,u,e,o;if(s!=undefined&&s!=null&&s!=3&&(h=0,$.each(i,function(n,t){r.value==t[2]&&(h=t[3])}),t._data[t._cTripIndex]&&typeof t._data[t._cTripIndex].Ts[r.value]!="undefined")){if(c=t._data[t._cTripIndex].Ts[r.value][0].NS-h,f="",_dict._hasDriverTrip)if(u=null,t._data[t._cTripIndex].Ts[r.value][0].TripDriver!=null)if(u=t._data[t._cTripIndex].Ts[r.value][0].TripDriver.split("~"),u.length>1){for(e=0;e<u.length;e++)if(o=u[e].split("|"),o[0]===r.value&&o[1]!=""){f+=o[1];break}}else u[0]!=""&&(f+=u[0]);else if(t._data[t._cTripIndex].TripDriver!=null)if(u=t._data[t._cTripIndex].TripDriver.split("~"),u.length>1){for(e=0;e<u.length;e++)if(o=u[e].split("|"),o[0]===r.value&&o[1]!=""){f+=o[1];break}}else u[0]!=""&&(f+=u[0]);f!=""?(t._data[t._cTripIndex].Ts[r.value][0].S==2&&(f+=" - (TC)"),f+=" / Ghế trống "+c+" / "+r.value):(f+=r.value,t._data[t._cTripIndex].Ts[r.value][0].S==2&&(f+=" - (TC)"),f+=" / Ghế trống "+c);$(r).text(f)}})},_reloadTimeSlot:function(n){var t=n.d.value,e=$("#FilterForm select[name=TimeSlot]").empty(),c=new Date,u,o,i,r,l,s,h;if(c.setSeconds(0),u=new Date(t._cTripDate.getTime()),u.setSeconds(0),o={},t._data[t._cTripIndex])for(i=Object.keys(t._data[t._cTripIndex].Ts),l=i.length,i.sort(),r=0;r<l;r++)if(app.rights.indexOf($.rights.bUBlockBks.val)==-1)if(typeof _dict._hasBlockBKSByTime!="undefined"&&_dict._hasBlockBKSByTime&&typeof _dict._dayBlockBKS!="undefined"&&typeof _dict._hourBlockBKS!="undefined"&&typeof _dict._minuteBlockBKS!="undefined"){var v=_dict._dayBlockBKS,y=_dict._hourBlockBKS,p=_dict._minuteBlockBKS,f=new Date;if(f.setDate(f.getDate()-v),f.setHours(f.getHours()-y),f.setMinutes(f.getMinutes()-p),i[r]!=null){var a=i[r].split(":"),w=parseInt(a[0]),b=parseInt(a[1]);u.setHours(w);u.setMinutes(b);f<=u&&(o[i[r]]=t._data[t._cTripIndex].Ts[i[r]])}}else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];else o[i[r]]=t._data[t._cTripIndex].Ts[i[r]];s=!1;$.each(o,function(n,i){var f=n,r,o;i[0].S==2?f+=" - (TC)":i[0].S==3&&(f+=" - (Hủy)");r=$("<option />",{text:f,value:n});s||(o=n.split(":"),u.setHours(parseInt(o[0])),u.setMinutes(parseInt(o[1])),t._cTripTime!=null?n==t._cTripTime&&(r.attr("selected",!0),s=!0,app.cTime=t._cTripTime):u>c&&(r.attr("selected",!0),s=!0,app.cTime=n));e.append(r)});s||(h=e.find("option:first-child"),h.attr("selected",!0),vbf("doChangeCTripTime",{value:h.val()}),app.cTime=h.val());e.val()!=t._cTripTime&&(vbf("doChangeCTripTime",{value:e.val()}),app.cTime=e.val())}});
//# sourceMappingURL=p.min.js.map
